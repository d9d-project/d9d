<!DOCTYPE html>
<html lang="en">

<head>
    <script>
        // for search plugin notably
        const base_url = "https://d9d-project.github.io/d9d/";
    </script>
    <script>
    const darkTheme = window.matchMedia("(prefers-color-scheme: dark)");
    darkTheme.onchange = (e) => {
        if (e.matches) {
            document.documentElement.classList.add("dark")
            localStorage.theme = 'dark';
        } else {
            document.documentElement.classList.remove("dark")
            localStorage.removeItem("theme")
        }
    };

    // On page load. Priotiry to lcaolStorage
    if (localStorage.theme === "dark") {
        document.documentElement.classList.add("dark")
    } else if (localStorage.theme === "light") {
        document.documentElement.classList.remove("dark")
    } else if (darkTheme.matches) {
        document.documentElement.classList.add("dark")
    } else {
        document.documentElement.classList.remove("dark")
    }

    // set the layout based on localStorage
    document.documentElement.classList.add(localStorage.getItem("html-layout") || "layout-fixed");
</script>


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Interfaces & Logic - d9d</title>
    


<title>Interfaces & Logic</title>









<link rel="canonical" href="https://d9d-project.github.io/d9d/0_loop/interfaces/">


<!-- Open Graph (Facebook, LinkedIn) -->

<meta property="og:title" content="Interfaces & Logic">





<meta property="og:url" content="https://d9d-project.github.io/d9d/0_loop/interfaces/">






<!-- Twitter Card -->

<meta name="twitter:title" content="Interfaces & Logic">






<!-- JSON-LD Structured Data -->



    <link rel="icon" href="../../img/favicon.ico">

    <link href="../../css/base.css" rel="stylesheet">
    <link href="../../css/geist.css" rel="stylesheet">

    
    

<link id="pygments-light" rel="stylesheet"
    href="../../css/pygments/a11y-light.css">
<link id="pygments-dark" rel="stylesheet"
    href="../../css/pygments/a11y-dark.css"
    media="(prefers-color-scheme: dark)">


    
    <link href="../../assets/_mkdocstrings.css" rel="stylesheet">
    <link href="../../style/style.css" rel="stylesheet">

    

    <script src="../../js/callbacks.js"></script>

    
    <!-- katex -->
<link rel="stylesheet" href="../../css/katex.min.css">
<!-- The loading of KaTeX is deferred to speed up page rendering -->
<script defer src="../../js/katex.min.js"></script>
<!-- To automatically render math in text elements, include the auto-render extension: -->
<script defer src="../../js/auto-render.min.js"
    onload='renderMathInElement(document.body, "{}");'></script>
    

    

    

</head>

<body
    class="text-foreground group/body overscroll-none font-sans antialiased [--footer-height:calc(var(--spacing)*14)] [--header-height:calc(var(--spacing)*14)] xl:[--footer-height:calc(var(--spacing)*24)] theme-default">
    <div id="inner-body" class="bg-background relative z-10 flex min-h-svh flex-col">
        <header class="bg-background sticky top-0 z-50 w-full" view-transition-name="header">
    <div class="container-wrapper 3xl:fixed:px-0 px-6">
        <div class="3xl:fixed:container flex h-(--header-height) items-center gap-2 **:data-[slot=separator]:!h-4">
            <button id="menu-button" data-slot="popover-trigger" onclick="onMobileMenuButtonClick(event)"
                class="group whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:text-accent-foreground px-4 py-2 has-[&gt;svg]:px-3 extend-touch-target h-8 touch-manipulation items-center justify-start gap-2.5 !p-0 hover:bg-transparent focus-visible:bg-transparent focus-visible:ring-0 active:bg-transparent dark:hover:bg-transparent flex lg:hidden"
                type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«Rmplb»"
                data-state="closed">
                <div class="relative flex h-8 w-4 items-center justify-center">
                    <div class="relative size-4">
                        <!-- 16px x 16px -->
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="0" x2="16" y1="5" y2="5"
                                class="group-data-[state=open]:translate-y-[2.25px] group-data-[state=open]:-translate-x-[2.25px] group-data-[state=open]:rotate-45 transition-all duration-300 origin-center" />
                            <line x1="0" x2="16" y1="11" y2="11"
                                class="group-data-[state=open]:-translate-y-[2.25px] group-data-[state=open]:-translate-x-[2.25px] group-data-[state=open]:-rotate-45 transition-all duration-300 origin-center" />
                        </svg>
                    </div>

                    <span class="sr-only">Toggle Menu</span>
                </div>
                <span class="flex h-8 items-center text-lg leading-none font-medium">Menu</span>
            </button>
            <a data-slot="button"
                class="items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-5 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 hidden h-8 lg:flex"
                href="https://d9d-project.github.io/d9d/">
                <span class="size-8 flex flex-row justify-center items-center">
                    

<img class="size-5" src="https://avatars.githubusercontent.com/u/248787421" alt="icon">


                </span>

                
                <h1 class="pr-2">d9d</h1>
                
            </a>
            
            <div class="ml-auto flex items-center gap-2 md:flex-1 md:justify-end">
                <div class="hidden w-full flex-1 md:flex md:w-auto md:flex-none">
                    <button data-slot="dialog-trigger" onclick="onSearchBarClick(event)"
    class="inline-flex items-center gap-2 whitespace-nowrap rounded-md text-sm transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-secondary/80 px-4 py-2 has-[&gt;svg]:px-3 bg-surface text-surface-foreground/60 dark:bg-card relative h-8 w-full justify-start pl-2.5 font-normal shadow-none sm:pr-12 md:w-40 lg:w-56 xl:w-64"
    type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«R66plb»" data-state="closed">
    <span class="text-muted-foreground hidden lg:inline-flex">Search documentation...</span>
    <span class="text-muted-foreground inline-flex lg:hidden">Search...</span>
    <div class="absolute top-1.5 right-1.5 hidden gap-1 sm:flex">
        <kbd
            class="bg-background text-muted-foreground pointer-events-none flex h-5 items-center justify-center gap-1 rounded border px-1 font-sans text-[0.7rem] font-medium select-none [&amp;_svg:not([class*='size-'])]:size-3">Ctrl</kbd><kbd
            class="bg-background text-muted-foreground pointer-events-none flex h-5 items-center justify-center gap-1 rounded border px-1 font-sans text-[0.7rem] font-medium select-none [&amp;_svg:not([class*='size-'])]:size-3 aspect-square">K</kbd>
    </div>
</button>
<dialog id="search-dialog" onclick="onSearchDialogClick(event)"
    class="fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-background rounded-lg shadow-lg border overflow-hidden p-0">
    <div class="w-lg gap-4">
        <div class="flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground">
            <div data-slot="command-input-wrapper" class="flex h-9 items-center gap-2 border-b px-3"><svg
                    xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="lucide lucide-search size-4 shrink-0 opacity-50">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.3-4.3"></path>
                </svg>
                <input data-slot="command-input"
                    class="placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50"
                    placeholder="Search documentation..." cmdk-input="" autocomplete="off" autocorrect="off"
                    spellcheck="false" aria-autocomplete="list" role="combobox" aria-expanded="true"
                    aria-controls="radix-«r1t6»" aria-labelledby="radix-«r1t7»" id="radix-«r1t8»" type="text" value=""
                    aria-activedescendant="radix-«r1th»" oninput="onInputHandler(event)">
            </div>
        </div>
        <div id="mkdocs-search-results">
            <!-- search results go there -->
        </div>
    </div>
</dialog>
<script>
    document.removeEventListener("keydown", searchShortcutHandler);
    document.addEventListener("keydown", searchShortcutHandler);
</script>
                </div>
                <div data-orientation="vertical" role="none" data-slot="separator"
                    class="bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px ml-2 hidden lg:block">
                </div>
                <a target="_blank" rel="noreferrer" data-slot="button"
                    class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 h-8 shadow-none"
                    href="https://github.com/d9d-project/d9d">
                    <svg viewBox="0 0 438.549 438.549">
                        <path fill="currentColor"
                            d="M409.132 114.573c-19.608-33.596-46.205-60.194-79.798-79.8-33.598-19.607-70.277-29.408-110.063-29.408-39.781 0-76.472 9.804-110.063 29.408-33.596 19.605-60.192 46.204-79.8 79.8C9.803 148.168 0 184.854 0 224.63c0 47.78 13.94 90.745 41.827 128.906 27.884 38.164 63.906 64.572 108.063 79.227 5.14.954 8.945.283 11.419-1.996 2.475-2.282 3.711-5.14 3.711-8.562 0-.571-.049-5.708-.144-15.417a2549.81 2549.81 0 01-.144-25.406l-6.567 1.136c-4.187.767-9.469 1.092-15.846 1-6.374-.089-12.991-.757-19.842-1.999-6.854-1.231-13.229-4.086-19.13-8.559-5.898-4.473-10.085-10.328-12.56-17.556l-2.855-6.57c-1.903-4.374-4.899-9.233-8.992-14.559-4.093-5.331-8.232-8.945-12.419-10.848l-1.999-1.431c-1.332-.951-2.568-2.098-3.711-3.429-1.142-1.331-1.997-2.663-2.568-3.997-.572-1.335-.098-2.43 1.427-3.289 1.525-.859 4.281-1.276 8.28-1.276l5.708.853c3.807.763 8.516 3.042 14.133 6.851 5.614 3.806 10.229 8.754 13.846 14.842 4.38 7.806 9.657 13.754 15.846 17.847 6.184 4.093 12.419 6.136 18.699 6.136 6.28 0 11.704-.476 16.274-1.423 4.565-.952 8.848-2.383 12.847-4.285 1.713-12.758 6.377-22.559 13.988-29.41-10.848-1.14-20.601-2.857-29.264-5.14-8.658-2.286-17.605-5.996-26.835-11.14-9.235-5.137-16.896-11.516-22.985-19.126-6.09-7.614-11.088-17.61-14.987-29.979-3.901-12.374-5.852-26.648-5.852-42.826 0-23.035 7.52-42.637 22.557-58.817-7.044-17.318-6.379-36.732 1.997-58.24 5.52-1.715 13.706-.428 24.554 3.853 10.85 4.283 18.794 7.952 23.84 10.994 5.046 3.041 9.089 5.618 12.135 7.708 17.705-4.947 35.976-7.421 54.818-7.421s37.117 2.474 54.823 7.421l10.849-6.849c7.419-4.57 16.18-8.758 26.262-12.565 10.088-3.805 17.802-4.853 23.134-3.138 8.562 21.509 9.325 40.922 2.279 58.24 15.036 16.18 22.559 35.787 22.559 58.817 0 16.178-1.958 30.497-5.853 42.966-3.9 12.471-8.941 22.457-15.125 29.979-6.191 7.521-13.901 13.85-23.131 18.986-9.232 5.14-18.182 8.85-26.84 11.136-8.662 2.286-18.415 4.004-29.263 5.146 9.894 8.562 14.842 22.077 14.842 40.539v60.237c0 3.422 1.19 6.279 3.572 8.562 2.379 2.279 6.136 2.95 11.276 1.995 44.163-14.653 80.185-41.062 108.068-79.226 27.88-38.161 41.825-81.126 41.825-128.906-.01-39.771-9.818-76.454-29.414-110.049z">
                        </path>
                    </svg>
                    
                    <span id="stargazers" class="text-muted-foreground w-8 text-xs tabular-nums" onload="test()">
                    </span>
                    
                </a>
                <div data-orientation="vertical" role="none" data-slot="separator"
                    class="bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px 3xl:flex hidden">
                </div>
                <button data-slot="button"
                    class="items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 size-8 3xl:flex hidden"
                    title="Toggle layout" onclick="toggleLayout(event)">
                    <span class="sr-only">Toggle layout</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        class="lucide lucide-gallery-horizontal">
                        <path d="M2 3v18"></path>
                        <rect width="12" height="18" x="6" y="3" rx="2"></rect>
                        <path d="M22 3v18"></path>
                    </svg>
                </button>
                <div data-orientation="vertical" role="none" data-slot="separator"
                    class="bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px">
                </div>
                <button data-slot="button"
                    class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 group/toggle extend-touch-target size-8"
                    title="Toggle theme" onclick="onThemeSwitch(event)">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        class="size-4.5">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                        <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path>
                        <path d="M12 3l0 18"></path>
                        <path d="M12 9l4.65 -4.65"></path>
                        <path d="M12 14.3l7.37 -7.37"></path>
                        <path d="M12 19.6l8.85 -8.85"></path>
                    </svg>
                    <span class="sr-only">Toggle theme</span>
                </button>
            </div>
        </div>
    </div>
</header>
        <main class="flex flex-1 flex-col">
            <div class="container-wrapper flex flex-1 flex-col px-2">
                <div data-slot="sidebar-wrapper" style="--sidebar-width: 16rem; --sidebar-width-icon: 3rem;"
                    class="group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex w-full 3xl:fixed:container 3xl:fixed:px-3 min-h-min flex-1 items-start px-0 [--sidebar-width:220px] [--top-spacing:0] lg:grid lg:grid-cols-[var(--sidebar-width)_minmax(0,1fr)] lg:[--sidebar-width:240px] lg:[--top-spacing:calc(var(--spacing)*4)]">
                    <div data-slot="sidebar"
                        class="text-sidebar-foreground w-(--sidebar-width) flex-col sticky top-[calc(var(--header-height)+1px)] z-30 hidden h-[calc(100svh-var(--header-height)-var(--footer-height))] bg-transparent lg:flex">
                        <div data-slot="sidebar-content" data-sidebar="content"
                            class="flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden no-scrollbar px-2 pb-12">
                            <div class="h-(--top-spacing) shrink-0"></div>
                            <div view-transition-name="sidebar" data-slot="sidebar-group" data-sidebar="group"
    class="relative flex w-full min-w-0 flex-col p-2 no-scrollbar">
    

    
    
    

    

    
    

    
    <div data-slot="sidebar-group" data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2">
        <div data-slot="sidebar-group-content" data-sidebar="group-content" class="w-full text-sm">
            <ul data-slot="sidebar-menu" data-sidebar="menu" class="flex w-full min-w-0 flex-col gap-0.5">
                
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Home
        

        

        

        
    </a>
</li>
                
                
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/toc/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Table of Contents
        

        

        

        
    </a>
</li>
                
                
            </ul>
        </div>
    </div>
    

    
    
    <div data-slot="sidebar-group" data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2">
        <div data-slot="sidebar-group-label" data-sidebar="group-label"
            class="ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 text-muted-foreground font-medium">
            Loop</div>
        <div data-slot="sidebar-group-content" data-sidebar="group-content" class="w-full text-sm">
            <ul data-slot="sidebar-menu" data-sidebar="menu" class="flex w-full min-w-0 flex-col gap-0.5">
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/0_loop/0_index/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Training Loop
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/0_loop/1_inference_loop/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Inference Loop
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/0_loop/config/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Configuration
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="true" data-sidebar="menu-button"
        data-size="default" href="/d9d/0_loop/interfaces/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Interfaces & Logic
        

        

        

        
    </a>
</li>
                
            </ul>
        </div>
    </div>
    
    
    
    <div data-slot="sidebar-group" data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2">
        <div data-slot="sidebar-group-label" data-sidebar="group-label"
            class="ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 text-muted-foreground font-medium">
            Core</div>
        <div data-slot="sidebar-group-content" data-sidebar="group-content" class="w-full text-sm">
            <ul data-slot="sidebar-menu" data-sidebar="menu" class="flex w-full min-w-0 flex-col gap-0.5">
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/core/autograd_extensions/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Autograd Extensions
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/core/dist_context/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Distributed Context
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/core/dist_ops/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Distributed Operations
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/core/sharding/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        PyTree Sharding
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/core/types/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Typing Extensions
        

        

        

        
    </a>
</li>
                
            </ul>
        </div>
    </div>
    
    
    
    <div data-slot="sidebar-group" data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2">
        <div data-slot="sidebar-group-label" data-sidebar="group-label"
            class="ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 text-muted-foreground font-medium">
            Dataset</div>
        <div data-slot="sidebar-group-content" data-sidebar="group-content" class="w-full text-sm">
            <ul data-slot="sidebar-menu" data-sidebar="menu" class="flex w-full min-w-0 flex-col gap-0.5">
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/dataset/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Datasets
        

        

        

        
    </a>
</li>
                
            </ul>
        </div>
    </div>
    
    
    
    <div data-slot="sidebar-group" data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2">
        <div data-slot="sidebar-group-label" data-sidebar="group-label"
            class="ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 text-muted-foreground font-medium">
            Internals</div>
        <div data-slot="sidebar-group-content" data-sidebar="group-content" class="w-full text-sm">
            <ul data-slot="sidebar-menu" data-sidebar="menu" class="flex w-full min-w-0 flex-col gap-0.5">
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/internals/determinism/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Determinism
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/internals/grad_norm/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Gradient Norm & Clipping
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/internals/grad_sync/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Gradient Synchronization
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/internals/metric_collector/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Metric Collection
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/internals/pipeline_state/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Pipeline State Management
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/internals/pipelining/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Pipelining Internals
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/internals/profiling/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Distributed Profiling
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/internals/tracker_integration/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Experiment Tracking
        

        

        

        
    </a>
</li>
                
            </ul>
        </div>
    </div>
    
    
    
    <div data-slot="sidebar-group" data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2">
        <div data-slot="sidebar-group-label" data-sidebar="group-label"
            class="ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 text-muted-foreground font-medium">
            Lr scheduler</div>
        <div data-slot="sidebar-group-content" data-sidebar="group-content" class="w-full text-sm">
            <ul data-slot="sidebar-menu" data-sidebar="menu" class="flex w-full min-w-0 flex-col gap-0.5">
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/lr_scheduler/piecewise/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Piecewise Scheduler
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/lr_scheduler/visualization/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Visualization
        

        

        

        
    </a>
</li>
                
            </ul>
        </div>
    </div>
    
    
    
    <div data-slot="sidebar-group" data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2">
        <div data-slot="sidebar-group-label" data-sidebar="group-label"
            class="ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 text-muted-foreground font-medium">
            Metric</div>
        <div data-slot="sidebar-group-content" data-sidebar="group-content" class="w-full text-sm">
            <ul data-slot="sidebar-menu" data-sidebar="menu" class="flex w-full min-w-0 flex-col gap-0.5">
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/metric/0_index/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Metrics
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/metric/custom/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Custom Metrics
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/metric/implemented/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Implemented Metrics
        

        

        

        
    </a>
</li>
                
            </ul>
        </div>
    </div>
    
    
    
    <div data-slot="sidebar-group" data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2">
        <div data-slot="sidebar-group-label" data-sidebar="group-label"
            class="ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 text-muted-foreground font-medium">
            Model states</div>
        <div data-slot="sidebar-group-content" data-sidebar="group-content" class="w-full text-sm">
            <ul data-slot="sidebar-menu" data-sidebar="menu" class="flex w-full min-w-0 flex-col gap-0.5">
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/model_states/io/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Model State I/O
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/model_states/mapper/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Model State Mapper
        

        

        

        
    </a>
</li>
                
            </ul>
        </div>
    </div>
    
    
    
    <div data-slot="sidebar-group" data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2">
        <div data-slot="sidebar-group-label" data-sidebar="group-label"
            class="ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 text-muted-foreground font-medium">
            Models</div>
        <div data-slot="sidebar-group-content" data-sidebar="group-content" class="w-full text-sm">
            <ul data-slot="sidebar-menu" data-sidebar="menu" class="flex w-full min-w-0 flex-col gap-0.5">
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/models/1_model_design/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Model Design
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/models/2_horizontal_parallelism/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Horizontal Parallelism
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/models/3_pipeline_parallelism/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Pipeline Parallelism
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/models/4_model_catalogue/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Model Catalogue
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/models/qwen3_moe/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Qwen3 MoE
        

        

        

        
    </a>
</li>
                
            </ul>
        </div>
    </div>
    
    
    
    <div data-slot="sidebar-group" data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2">
        <div data-slot="sidebar-group-label" data-sidebar="group-label"
            class="ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 text-muted-foreground font-medium">
            Modules</div>
        <div data-slot="sidebar-group-content" data-sidebar="group-content" class="w-full text-sm">
            <ul data-slot="sidebar-menu" data-sidebar="menu" class="flex w-full min-w-0 flex-col gap-0.5">
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/modules/attention/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Attention Layers
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/modules/embedding/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Embeddings
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/modules/ffn/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Feed Forward Networks (FFN)
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/modules/head/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Model Heads
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/modules/hidden_states_aggregator/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Hidden States Aggregation
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/modules/moe/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Mixture of Experts (MoE)
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/modules/positional/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Positional Embeddings
        

        

        

        
    </a>
</li>
                
            </ul>
        </div>
    </div>
    
    
    
    <div data-slot="sidebar-group" data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2">
        <div data-slot="sidebar-group-label" data-sidebar="group-label"
            class="ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 text-muted-foreground font-medium">
            Optimizer</div>
        <div data-slot="sidebar-group-content" data-sidebar="group-content" class="w-full text-sm">
            <ul data-slot="sidebar-menu" data-sidebar="menu" class="flex w-full min-w-0 flex-col gap-0.5">
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/optimizer/stochastic/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Stochastic Optimizers
        

        

        

        
    </a>
</li>
                
            </ul>
        </div>
    </div>
    
    
    
    <div data-slot="sidebar-group" data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2">
        <div data-slot="sidebar-group-label" data-sidebar="group-label"
            class="ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 text-muted-foreground font-medium">
            Peft</div>
        <div data-slot="sidebar-group-content" data-sidebar="group-content" class="w-full text-sm">
            <ul data-slot="sidebar-menu" data-sidebar="menu" class="flex w-full min-w-0 flex-col gap-0.5">
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/peft/0_index/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        PEFT Overview
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/peft/full_tune/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Full Fine-Tuning
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/peft/lora/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        LoRA
        

        

        

        
    </a>
</li>
                
                <li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative">
    <a data-slot="sidebar-menu-button" data-active="false" data-sidebar="menu-button"
        data-size="default" href="/d9d/peft/stack/"
        class="hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer/menu-button flex items-center gap-2 rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 data-[active=true]:bg-accent data-[active=true]:border-accent 3xl:fixed:w-full 3xl:fixed:max-w-48 relative h-[30px] w-fit overflow-visible border border-transparent text-[0.8rem] font-medium after:absolute after:inset-x-0 after:-inset-y-1 after:z-0 after:rounded-md">

        
        Method Stacking
        

        

        

        
    </a>
</li>
                
            </ul>
        </div>
    </div>
    
    


    
</div>
                        </div>
                    </div>
                    <div class="h-full w-full">
                        <div data-slot="docs" class="flex items-stretch text-[1.05rem] sm:text-[15px] xl:w-full">
                            <div class="flex min-w-0 flex-1 flex-col">
                                <div class="h-(--top-spacing) shrink-0"></div>
                                <article class="w-full" view-transition-name="page">
  <div class="flex flex-col gap-2">
    <div class="flex flex-col gap-2">
      <div id="page-header" class="flex items-start justify-between">
        <h1
          class="scroll-m-20 text-4xl font-semibold tracking-tight sm:text-3xl xl:text-4xl"
        >
          Interfaces & Logic
        </h1>

        <div class="flex items-center gap-2 pt-1.5">
          
<button onclick="fetch(`https://d9d-project.github.io/d9d/0_loop/interfaces.md`).then((r) => r.blob()).then((blob) => navigator.clipboard.write([new ClipboardItem({ 'text/plain': blob })]))" 
        data-slot="button" 
        class="cursor-pointer inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive bg-secondary text-secondary-foreground hover:bg-secondary/80 rounded-md gap-1.5 px-3 has-[&>svg]:px-2.5 h-8 shadow-none md:h-7 md:text-[0.8rem]">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="tabler-icon tabler-icon-copy ">
    <path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z"></path><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1"></path>
</svg>
<span class="max-md:hidden">Copy Page</span>
</button> 
          
          <a
            data-slot="button"
            id="previous-button"
            class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive bg-secondary text-secondary-foreground hover:bg-secondary/80 extend-touch-target size-8 shadow-none md:size-7"
            href="/d9d/0_loop/config/"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="tabler-icon tabler-icon-arrow-left"
            >
              <path d="M5 12l14 0"></path>
              <path d="M5 12l6 6"></path>
              <path d="M5 12l6 -6"></path>
            </svg>
            <span class="sr-only">Previous</span>
          </a>
           
          
          <a
            data-slot="button"
            id="next-button"
            class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive bg-secondary text-secondary-foreground hover:bg-secondary/80 extend-touch-target size-8 shadow-none md:size-7"
            href="/d9d/core/autograd_extensions/"
          >
            <span class="sr-only">Next</span>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="tabler-icon tabler-icon-arrow-right"
            >
              <path d="M5 12l14 0"></path>
              <path d="M13 18l6 -6"></path>
              <path d="M13 6l6 6"></path>
            </svg>
          </a>
          
        </div>
      </div>
      
    </div>
    <div class="flex justify-end items-center">
        <div class="grow text-muted-foreground pt-4 flex flex-row justify-end items-center">
    <span id="updated_at" class="text-sm opacity-50 hover:opacity-100 transition-opacity duration-200"
        title="last update (local time)"></span>
</div>

<script>
    const updatedAt = document.getElementById("updated_at");
    if (updatedAt) {
        const date = new Date('2026-02-13T00:36:14+03:00');
        updatedAt.textContent = date.toLocaleDateString();
    }
</script>
 
    </div>
  </div>
  <div class="typography w-full flex-1 *:data-[slot=alert]:first:mt-0">
    <h2 id="about">About</h2>
<p>The <code>d9d</code> training loop is agnostic to the specific model or data being trained. You interact with the loop by implementing <strong>Providers</strong> (factories) and <strong>Tasks</strong> (step logic).</p>
<p>For standard use cases (like standard Optimizers), <code>d9d</code> provides <strong>Auto</strong> implementations that can be configured purely via Pydantic models, avoiding the need to write custom provider classes.</p>
<h2 id="user-tasks">User Tasks</h2>
<p>A <strong>Task</strong> defines custom logic for a single train/inference step.</p>
<p>Each <strong>Task</strong> may implement <code>Stateful</code> protocol, so you may store some mutable state here.</p>
<h3 id="traintask">TrainTask</h3>
<p>It is responsible for logging metrics, mapping batch inputs before they are fed into the model, and for computing the task loss function value.</p>
<p><strong>Init</strong>: <code>create_metrics(...)</code>, <code>dump_hparams(...)</code>.</p>
<p><strong>Lifecycle</strong>: </p>
<ol>
<li><code>build_forward_inputs(...)</code> (will be called once) -&gt; </li>
<li><code>compute_loss(...)</code> (will be called multiple times if pipelining is enabled - once for each pipeline microbatch) -&gt; </li>
<li><code>update_metrics(...)</code> (will be called once).</li>
</ol>
<p><strong>Exit</strong>: <code>finalize(...)</code>.</p>
<p><strong>State Management</strong>: <code>state_dict(...)</code>, <code>load_state_dict(...)</code>.</p>
<h3 id="inferencetask">InferenceTask</h3>
<p>The <code>InferenceTask</code> defines the logic for a single inference step. </p>
<p>It is designed to handle the <strong>forward-only</strong> flow, processing the raw tensors synthesized by the model (e.g., logits, hidden states).</p>
<p><strong>Lifecycle</strong>: </p>
<ol>
<li><code>build_forward_inputs(...)</code> (called once) -&gt; </li>
<li><code>process_outputs(...)</code> (called once per pipeline microbatch).</li>
</ol>
<p><strong>Exit</strong>: <code>finalize(...)</code>.</p>
<p><strong>State Management</strong>: <code>state_dict(...)</code>, <code>load_state_dict(...)</code>.</p>
<h3 id="pipeline-state">Pipeline State</h3>
<p>You may note that <code>batch</code> is only accessible in <code>build_forward_inputs(...)</code> method, but not in others. Don't worry!</p>
<p>There is an object for transferring any state between the <strong>Task Lifecycle</strong> stages, - it is called <code>PipelineState</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="n">ctx</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>

<span class="c1"># ...</span>

<span class="n">metrics</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">])</span>
</code></pre></div>

<p>The pipeline state will automatically shard and unshard data if needed.</p>
<p>You may read an <a href="../../internals/pipeline_state/">additional documentation</a> for its internal behaviour.</p>
<h3 id="example-implementation">Example Implementation</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">d9d.core.dist_context</span><span class="w"> </span><span class="kn">import</span> <span class="n">DistributedContext</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">d9d.core.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">ScalarTree</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">d9d.module.block.head</span><span class="w"> </span><span class="kn">import</span> <span class="n">LM_IGNORE_INDEX</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">d9d.loop.control</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SFTTask</span><span class="p">(</span><span class="n">TrainTask</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dist_ctx</span><span class="p">:</span> <span class="n">DistributedContext</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dist_ctx</span> <span class="o">=</span> <span class="n">dist_ctx</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build_forward_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">BuildForwardInputsContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BuildForwardInputsResult</span><span class="p">:</span>
        <span class="c1"># ctx.batch contains the output of the Collator.</span>

        <span class="c1"># Save labels in state for access during loss computation later</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">batch</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span>

        <span class="c1"># Return inputs for model.forward()</span>
        <span class="c1"># inputs are only for the first pipeline stage</span>
        <span class="c1"># kwargs are the same for all the pipeline stages</span>
        <span class="k">return</span> <span class="n">BuildForwardInputsResult</span><span class="p">(</span>
            <span class="n">inputs</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;input_ids&quot;</span><span class="p">:</span> <span class="n">ctx</span><span class="o">.</span><span class="n">batch</span><span class="p">[</span><span class="s2">&quot;input_ids&quot;</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="n">ctx</span><span class="o">.</span><span class="n">batch</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">],</span>
                <span class="s2">&quot;position_ids&quot;</span><span class="p">:</span> <span class="n">ctx</span><span class="o">.</span><span class="n">batch</span><span class="p">[</span><span class="s2">&quot;position_ids&quot;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dump_hparams</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScalarTree</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">dump_hparams</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">compute_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">ComputeLossContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ComputeLossResult</span><span class="p">:</span>
        <span class="c1"># Retrieve log_probs calculated by the model pipeline</span>
        <span class="n">logps</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">pipeline_results</span><span class="p">[</span><span class="s2">&quot;logps&quot;</span><span class="p">]</span>

        <span class="c1"># Calculate number of valid tokens (ignoring the -100 padding)</span>
        <span class="c1"># This is crucial for variable length batches.</span>
        <span class="n">num_loss_tokens</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">LM_IGNORE_INDEX</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="c1"># Calculate average loss per valid token</span>
        <span class="n">total_loss</span> <span class="o">=</span> <span class="n">logps</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">num_loss_tokens</span>

        <span class="k">return</span> <span class="n">ComputeLossResult</span><span class="p">(</span>
            <span class="n">loss</span><span class="o">=</span><span class="n">total_loss</span><span class="p">,</span>
            <span class="c1"># loss_weight is used for gradient accumulation across the distributed world.</span>
            <span class="c1"># If batches have different token counts, we weigh the gradient</span>
            <span class="c1"># by token count to get a mathematical true average over the accumulation steps.</span>
            <span class="n">loss_weight</span><span class="o">=</span><span class="n">num_loss_tokens</span> <span class="o">/</span> <span class="mi">1000</span>
        <span class="p">)</span>
</code></pre></div>

<h3 id="api-reference">API Reference</h3>


<div class="doc doc-object doc-module">



<h3 id="d9d.loop.control.task" class="doc doc-heading">
            <code>d9d.loop.control.task</code>


</h3>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.task.BaseTask" class="doc doc-heading">
            <code>BaseTask</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code>, <code><span title="torch.distributed.checkpoint.stateful.Stateful">Stateful</span></code>, <code><span title="typing.Generic">Generic</span>[<span title="d9d.loop.control.task.TBatch">TBatch</span>]</code></p>



        <p>Abstract base class representing a unit of work (Task) in the training/inference loop.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BaseTask</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">,</span> <span class="n">Stateful</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">TBatch</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract base class representing a unit of work (Task) in the training/inference loop.&quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">build_forward_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">BuildForwardInputsContext</span><span class="p">[</span><span class="n">TBatch</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BuildForwardInputsResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transforms raw data loaded from the DataLoader into arguments for the model.</span>

<span class="sd">        Args:</span>
<span class="sd">            ctx: Context object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Result object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">state_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the state dictionary for checkpointing this task.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dictionary containing the task&#39;s state.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_state_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Restores the task&#39;s state from the provided dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            state_dict: The state dictionary to load.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># do nothing by default</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">FinalizeContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs cleanup or final actions when the task execution finishes.</span>

<span class="sd">        Args:</span>
<span class="sd">             ctx: Context object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="d9d.loop.control.task.BaseTask.build_forward_inputs" class="doc doc-heading">
            <code class=" language-python"><span class="n">build_forward_inputs</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Transforms raw data loaded from the DataLoader into arguments for the model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ctx</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="BuildForwardInputsContext


  
      dataclass
   (d9d.loop.control.task.BuildForwardInputsContext)" href="#d9d.loop.control.task.BuildForwardInputsContext">BuildForwardInputsContext</a>[<span title="d9d.loop.control.task.TBatch">TBatch</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Context object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table></div>


    <p><span class="doc-section-title">Returns:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="BuildForwardInputsResult


  
      dataclass
   (d9d.loop.control.task.BuildForwardInputsResult)" href="#d9d.loop.control.task.BuildForwardInputsResult">BuildForwardInputsResult</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Result object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">build_forward_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">BuildForwardInputsContext</span><span class="p">[</span><span class="n">TBatch</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BuildForwardInputsResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms raw data loaded from the DataLoader into arguments for the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        ctx: Context object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Result object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="o">...</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="d9d.loop.control.task.BaseTask.finalize" class="doc doc-heading">
            <code class=" language-python"><span class="n">finalize</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Performs cleanup or final actions when the task execution finishes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ctx</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FinalizeContext


  
      dataclass
   (d9d.loop.control.task.FinalizeContext)" href="#d9d.loop.control.task.FinalizeContext">FinalizeContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Context object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">FinalizeContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs cleanup or final actions when the task execution finishes.</span>

<span class="sd">    Args:</span>
<span class="sd">         ctx: Context object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="d9d.loop.control.task.BaseTask.load_state_dict" class="doc doc-heading">
            <code class=" language-python"><span class="n">load_state_dict</span><span class="p">(</span><span class="n">state_dict</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Restores the task's state from the provided dictionary.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The state dictionary to load.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_state_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Restores the task&#39;s state from the provided dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        state_dict: The state dictionary to load.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="d9d.loop.control.task.BaseTask.state_dict" class="doc doc-heading">
            <code class=" language-python"><span class="n">state_dict</span><span class="p">()</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Returns the state dictionary for checkpointing this task.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the task's state.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">state_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the state dictionary for checkpointing this task.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dictionary containing the task&#39;s state.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.task.BuildForwardInputsContext" class="doc doc-heading">
            <code>BuildForwardInputsContext</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="d9d.loop.control.task.TBatch">TBatch</span>]</code></p>



        <p>Context data to prepare inputs for the model forward pass.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.task.BuildForwardInputsContext.batch">batch</span></code></td>
            <td>
                  <code><span title="d9d.loop.control.task.TBatch">TBatch</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The raw batch data loaded from the DataLoader object.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.task.BuildForwardInputsContext.state">state</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PipelineState (d9d.internals.pipeline_state.PipelineState)" href="../../internals/pipeline_state/#d9d.internals.pipeline_state.PipelineState">PipelineState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current state of the pipeline. You can assign any data to this state object, and it will be
accessible during this pipeline step (e.g. when computing loss)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BuildForwardInputsContext</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">TBatch</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Context data to prepare inputs for the model forward pass.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        batch: The raw batch data loaded from the DataLoader object.</span>
<span class="sd">        state: The current state of the pipeline. You can assign any data to this state object, and it will be</span>
<span class="sd">            accessible during this pipeline step (e.g. when computing loss)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">batch</span><span class="p">:</span> <span class="n">TBatch</span>
    <span class="n">state</span><span class="p">:</span> <span class="s2">&quot;PipelineState&quot;</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.task.BuildForwardInputsResult" class="doc doc-heading">
            <code>BuildForwardInputsResult</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">



        <p>The result of processing the raw batch into model inputs.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.task.BuildForwardInputsResult.inputs">inputs</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of inputs that are passed to model pipeline as input data
(first stage only if using pipeline parallelism).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.task.BuildForwardInputsResult.kwargs">kwargs</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of keyword arguments passed to each pipeline stage.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.task.BuildForwardInputsResult.pipeline_sharding_spec">pipeline_sharding_spec</span></code></td>
            <td>
                  <code><span title="d9d.pipelining.api.PipelineShardingSpec">PipelineShardingSpec</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A specification defining how inputs and kwargs should be split
into micro-batches for pipeline parallelism. If None, the framework assumes
standard behavior where all the non-scalar Tensors and lists are split by 0 dimension.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BuildForwardInputsResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The result of processing the raw batch into model inputs.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        inputs: A dictionary of inputs that are passed to model pipeline as input data</span>
<span class="sd">            (first stage only if using pipeline parallelism).</span>
<span class="sd">        kwargs: A dictionary of keyword arguments passed to each pipeline stage.</span>
<span class="sd">        pipeline_sharding_spec: A specification defining how inputs and kwargs should be split</span>
<span class="sd">            into micro-batches for pipeline parallelism. If None, the framework assumes</span>
<span class="sd">            standard behavior where all the non-scalar Tensors and lists are split by 0 dimension.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">inputs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span>
    <span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
    <span class="n">pipeline_sharding_spec</span><span class="p">:</span> <span class="n">PipelineShardingSpec</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.task.ComputeLossContext" class="doc doc-heading">
            <code>ComputeLossContext</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">



        <p>Context data provided to calculate the loss during training.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.task.ComputeLossContext.pipeline_results">pipeline_results</span></code></td>
            <td>
                  <code><span title="collections.abc.Mapping">Mapping</span>[<span title="str">str</span>, <span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The outputs returned by the model's forward pass.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.task.ComputeLossContext.state">state</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PipelineState (d9d.internals.pipeline_state.PipelineState)" href="../../internals/pipeline_state/#d9d.internals.pipeline_state.PipelineState">PipelineState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current state of the pipeline. You can assign any data to this state object, and it will be
accessible during this pipeline step (e.g. when calculating metrics)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.task.ComputeLossContext.stepper">stepper</span></code></td>
            <td>
                  <code><span title="d9d.loop.component.Stepper">Stepper</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Component tracking the current step.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ComputeLossContext</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Context data provided to calculate the loss during training.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        pipeline_results: The outputs returned by the model&#39;s forward pass.</span>
<span class="sd">        state: The current state of the pipeline. You can assign any data to this state object, and it will be</span>
<span class="sd">            accessible during this pipeline step (e.g. when calculating metrics)</span>
<span class="sd">        stepper: Component tracking the current step.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">pipeline_results</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span>
    <span class="n">state</span><span class="p">:</span> <span class="s2">&quot;PipelineState&quot;</span>
    <span class="n">stepper</span><span class="p">:</span> <span class="s2">&quot;Stepper&quot;</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.task.ComputeLossResult" class="doc doc-heading">
            <code>ComputeLossResult</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">



        <p>The result of the loss computation.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.task.ComputeLossResult.loss">loss</span></code></td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The scalar tensor representing the loss to be backpropagated.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.task.ComputeLossResult.loss_weight">loss_weight</span></code></td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The weight to apply to the loss (for synchronizing gradients using weighted mean).
None for 1.0.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ComputeLossResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The result of the loss computation.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        loss: The scalar tensor representing the loss to be backpropagated.</span>
<span class="sd">        loss_weight: The weight to apply to the loss (for synchronizing gradients using weighted mean).</span>
<span class="sd">            None for 1.0.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">loss</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
    <span class="n">loss_weight</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.task.CreateMetricsContext" class="doc doc-heading">
            <code>CreateMetricsContext</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">



        <p>Context data provided to initialize metrics.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CreateMetricsContext</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Context data provided to initialize metrics.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.task.CreateMetricsResult" class="doc doc-heading">
            <code>CreateMetricsResult</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">



        <p>Result of metric initialization.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.task.CreateMetricsResult.metrics">metrics</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="Metric (d9d.metric.Metric)" href="../../metric/0_index/#d9d.metric.Metric">Metric</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary mapping metric names to Metric instances.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CreateMetricsResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Result of metric initialization.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        metrics: A dictionary mapping metric names to Metric instances.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">metrics</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;Metric&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.task.FinalizeContext" class="doc doc-heading">
            <code>FinalizeContext</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">



        <p>Context data provided when the task is being finalized.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FinalizeContext</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Context data provided when the task is being finalized.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.task.InferenceTask" class="doc doc-heading">
            <code>InferenceTask</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseTask (d9d.loop.control.task.BaseTask)" href="#d9d.loop.control.task.BaseTask">BaseTask</a></code>, <code><span title="abc.ABC">ABC</span></code>, <code><span title="typing.Generic">Generic</span>[<span title="d9d.loop.control.task.TBatch">TBatch</span>]</code></p>



        <p>Abstract base class for defining inference-specific logic.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">InferenceTask</span><span class="p">(</span><span class="n">BaseTask</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">TBatch</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract base class for defining inference-specific logic.&quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">process_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">ProcessOutputsContext</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Processes the model outputs (e.g. saving to disk, decoding tokens).</span>

<span class="sd">        Args:</span>
<span class="sd">            ctx: Context containing the model outputs and pipeline state.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="o">...</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="d9d.loop.control.task.InferenceTask.process_outputs" class="doc doc-heading">
            <code class=" language-python"><span class="n">process_outputs</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Processes the model outputs (e.g. saving to disk, decoding tokens).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ctx</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ProcessOutputsContext


  
      dataclass
   (d9d.loop.control.task.ProcessOutputsContext)" href="#d9d.loop.control.task.ProcessOutputsContext">ProcessOutputsContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Context containing the model outputs and pipeline state.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">process_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">ProcessOutputsContext</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Processes the model outputs (e.g. saving to disk, decoding tokens).</span>

<span class="sd">    Args:</span>
<span class="sd">        ctx: Context containing the model outputs and pipeline state.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="o">...</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.task.InferenceTaskProvider" class="doc doc-heading">
            <code>InferenceTaskProvider</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Protocol">Protocol</span></code></p>



        <p>Protocol for a callable that creates an InferenceTask instance.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typing</span><span class="o">.</span><span class="n">runtime_checkable</span>
<span class="k">class</span><span class="w"> </span><span class="nc">InferenceTaskProvider</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Protocol for a callable that creates an InferenceTask instance.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">InferenceTaskProviderContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InferenceTask</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates and returns a new InferenceTask.</span>

<span class="sd">        Args:</span>
<span class="sd">            ctx: Context providing distributed environment information.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An instantiated InferenceTask.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="d9d.loop.control.task.InferenceTaskProvider.__call__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Creates and returns a new InferenceTask.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ctx</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="InferenceTaskProviderContext


  
      dataclass
   (d9d.loop.control.task.InferenceTaskProviderContext)" href="#d9d.loop.control.task.InferenceTaskProviderContext">InferenceTaskProviderContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Context providing distributed environment information.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table></div>


    <p><span class="doc-section-title">Returns:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="InferenceTask (d9d.loop.control.task.InferenceTask)" href="#d9d.loop.control.task.InferenceTask">InferenceTask</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An instantiated InferenceTask.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">InferenceTaskProviderContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InferenceTask</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates and returns a new InferenceTask.</span>

<span class="sd">    Args:</span>
<span class="sd">        ctx: Context providing distributed environment information.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An instantiated InferenceTask.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.task.InferenceTaskProviderContext" class="doc doc-heading">
            <code>InferenceTaskProviderContext</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">



        <p>Context data provided to the factory creating an InferenceTask.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.task.InferenceTaskProviderContext.dist_context">dist_context</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DistributedContext (d9d.core.dist_context.DistributedContext)" href="../../core/dist_context/#d9d.core.dist_context.DistributedContext">DistributedContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Information about the distributed environment.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">InferenceTaskProviderContext</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Context data provided to the factory creating an InferenceTask.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        dist_context: Information about the distributed environment.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dist_context</span><span class="p">:</span> <span class="n">DistributedContext</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.task.ProcessOutputsContext" class="doc doc-heading">
            <code>ProcessOutputsContext</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">



        <p>Context data provided to process outputs during inference.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.task.ProcessOutputsContext.pipeline_results">pipeline_results</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The outputs returned by the model's forward pass.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.task.ProcessOutputsContext.state">state</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PipelineState (d9d.internals.pipeline_state.PipelineState)" href="../../internals/pipeline_state/#d9d.internals.pipeline_state.PipelineState">PipelineState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current state of the pipeline.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ProcessOutputsContext</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Context data provided to process outputs during inference.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        pipeline_results: The outputs returned by the model&#39;s forward pass.</span>
<span class="sd">        state: The current state of the pipeline.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">pipeline_results</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span>
    <span class="n">state</span><span class="p">:</span> <span class="s2">&quot;PipelineState&quot;</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.task.TrainTask" class="doc doc-heading">
            <code>TrainTask</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseTask (d9d.loop.control.task.BaseTask)" href="#d9d.loop.control.task.BaseTask">BaseTask</a></code>, <code><span title="abc.ABC">ABC</span></code>, <code><span title="typing.Generic">Generic</span>[<span title="d9d.loop.control.task.TBatch">TBatch</span>]</code></p>



        <p>Abstract base class for defining training-specific logic.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">TrainTask</span><span class="p">(</span><span class="n">BaseTask</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">TBatch</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract base class for defining training-specific logic.&quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">ComputeLossContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ComputeLossResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the loss based on model outputs.</span>

<span class="sd">        Args:</span>
<span class="sd">            ctx: Context object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Result object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">CreateMetricsContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CreateMetricsResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes metrics to be tracked during training.</span>

<span class="sd">        Args:</span>
<span class="sd">             ctx: Context object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Result object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">CreateMetricsResult</span><span class="p">(</span><span class="n">metrics</span><span class="o">=</span><span class="p">{})</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">UpdateMetricsContext</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the state of the metrics at the end of training step.</span>

<span class="sd">        Args:</span>
<span class="sd">            ctx: Context object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dump_hparams</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScalarTree</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports hyperparameters associated with this task for logging.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dictionary of hyperparameter names and values.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="d9d.loop.control.task.TrainTask.compute_loss" class="doc doc-heading">
            <code class=" language-python"><span class="n">compute_loss</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Calculates the loss based on model outputs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ctx</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ComputeLossContext


  
      dataclass
   (d9d.loop.control.task.ComputeLossContext)" href="#d9d.loop.control.task.ComputeLossContext">ComputeLossContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Context object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table></div>


    <p><span class="doc-section-title">Returns:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ComputeLossResult


  
      dataclass
   (d9d.loop.control.task.ComputeLossResult)" href="#d9d.loop.control.task.ComputeLossResult">ComputeLossResult</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Result object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">ComputeLossContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ComputeLossResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the loss based on model outputs.</span>

<span class="sd">    Args:</span>
<span class="sd">        ctx: Context object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Result object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="o">...</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="d9d.loop.control.task.TrainTask.create_metrics" class="doc doc-heading">
            <code class=" language-python"><span class="n">create_metrics</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Initializes metrics to be tracked during training.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ctx</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CreateMetricsContext


  
      dataclass
   (d9d.loop.control.task.CreateMetricsContext)" href="#d9d.loop.control.task.CreateMetricsContext">CreateMetricsContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Context object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table></div>


    <p><span class="doc-section-title">Returns:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CreateMetricsResult


  
      dataclass
   (d9d.loop.control.task.CreateMetricsResult)" href="#d9d.loop.control.task.CreateMetricsResult">CreateMetricsResult</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Result object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">CreateMetricsContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CreateMetricsResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes metrics to be tracked during training.</span>

<span class="sd">    Args:</span>
<span class="sd">         ctx: Context object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Result object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">CreateMetricsResult</span><span class="p">(</span><span class="n">metrics</span><span class="o">=</span><span class="p">{})</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="d9d.loop.control.task.TrainTask.dump_hparams" class="doc doc-heading">
            <code class=" language-python"><span class="n">dump_hparams</span><span class="p">()</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Exports hyperparameters associated with this task for logging.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ScalarTree = PyTree[str | float | int | bool]

  
      module-attribute
   (d9d.core.types.ScalarTree)" href="../../core/types/#d9d.core.types.ScalarTree">ScalarTree</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of hyperparameter names and values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dump_hparams</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScalarTree</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exports hyperparameters associated with this task for logging.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dictionary of hyperparameter names and values.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="d9d.loop.control.task.TrainTask.update_metrics" class="doc doc-heading">
            <code class=" language-python"><span class="n">update_metrics</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Updates the state of the metrics at the end of training step.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ctx</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="UpdateMetricsContext


  
      dataclass
   (d9d.loop.control.task.UpdateMetricsContext)" href="#d9d.loop.control.task.UpdateMetricsContext">UpdateMetricsContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Context object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">UpdateMetricsContext</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the state of the metrics at the end of training step.</span>

<span class="sd">    Args:</span>
<span class="sd">        ctx: Context object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.task.TrainTaskProvider" class="doc doc-heading">
            <code>TrainTaskProvider</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Protocol">Protocol</span></code></p>



        <p>Protocol that creates a TrainTask instance.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typing</span><span class="o">.</span><span class="n">runtime_checkable</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TrainTaskProvider</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Protocol that creates a TrainTask instance.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">TrainTaskProviderContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrainTask</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates and returns a new TrainTask.</span>

<span class="sd">        Args:</span>
<span class="sd">            ctx: Context object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An instantiated TrainTask.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="o">...</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="d9d.loop.control.task.TrainTaskProvider.__call__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Creates and returns a new TrainTask.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ctx</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TrainTaskProviderContext


  
      dataclass
   (d9d.loop.control.task.TrainTaskProviderContext)" href="#d9d.loop.control.task.TrainTaskProviderContext">TrainTaskProviderContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Context object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table></div>


    <p><span class="doc-section-title">Returns:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="TrainTask (d9d.loop.control.task.TrainTask)" href="#d9d.loop.control.task.TrainTask">TrainTask</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An instantiated TrainTask.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">TrainTaskProviderContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrainTask</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates and returns a new TrainTask.</span>

<span class="sd">    Args:</span>
<span class="sd">        ctx: Context object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An instantiated TrainTask.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="o">...</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.task.TrainTaskProviderContext" class="doc doc-heading">
            <code>TrainTaskProviderContext</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">



        <p>Context data provided to the factory creating a TrainTask.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.task.TrainTaskProviderContext.dist_context">dist_context</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DistributedContext (d9d.core.dist_context.DistributedContext)" href="../../core/dist_context/#d9d.core.dist_context.DistributedContext">DistributedContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Information about the distributed environment.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TrainTaskProviderContext</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Context data provided to the factory creating a TrainTask.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        dist_context: Information about the distributed environment.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dist_context</span><span class="p">:</span> <span class="n">DistributedContext</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.task.UpdateMetricsContext" class="doc doc-heading">
            <code>UpdateMetricsContext</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">



        <p>Context data provided to update metrics after a step.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.task.UpdateMetricsContext.state">state</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PipelineState (d9d.internals.pipeline_state.PipelineState)" href="../../internals/pipeline_state/#d9d.internals.pipeline_state.PipelineState">PipelineState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current state of the pipeline.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.task.UpdateMetricsContext.metrics">metrics</span></code></td>
            <td>
                  <code><span title="collections.abc.Mapping">Mapping</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="Metric (d9d.metric.Metric)" href="../../metric/0_index/#d9d.metric.Metric">Metric</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary of metrics to be updated.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/task.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UpdateMetricsContext</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Context data provided to update metrics after a step.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        state: The current state of the pipeline.</span>
<span class="sd">        metrics: The dictionary of metrics to be updated.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">state</span><span class="p">:</span> <span class="s2">&quot;PipelineState&quot;</span>
    <span class="n">metrics</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;Metric&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="model-definition">Model Definition</h2>
<h3 id="modelprovider">ModelProvider</h3>
<p>The <code>ModelProvider</code> controls the lifecycle of the <code>nn.Module</code>. In distributed training, models are rarely just "instantiated". </p>
<p>They must be initialized, parallelized, and mapped for loading from checkpoint.</p>
<h3 id="how-to-write-a-modelprovider">How to Write a ModelProvider</h3>
<h4 id="choose-a-model">Choose a Model</h4>
<p>Choose a model from d9d's <a href="../../models/4_model_catalogue/">catalogue</a> or <a href="../../models/1_model_design/">create it</a> by your own.</p>
<h4 id="implement-initialize_model_stage">Implement <code>initialize_model_stage(...)</code></h4>
<p>Implement the <code>initialize_model_stage(...)</code> method - it should prepare a <code>nn.Module</code> for specified <a href="../../models/3_pipeline_parallelism/">pipeline parallel</a> stage containing model architecture in a target <code>torch.dtype</code>.</p>
<p>Note that models are initialized on <strong>meta device</strong>, so you <strong>must not</strong> load model weights here.</p>
<p>Instead, this function should return a <a href="../../model_states/mapper/">State Mapper</a> that will map model weights <strong>on disk</strong> to model weights <strong>in-memory</strong>.</p>
<p>You also may apply <a href="../../peft/0_index/">PEFT</a> methods here and other architectural patches, but make sure you respect the changes they made in returned <a href="../../model_states/mapper/">State Mapper</a>.</p>
<h4 id="implement-parallelize_model_stage">Implement <code>parallelize_model_stage(...)</code></h4>
<p>Implement the <code>parallelize_model_stage(...)</code> method - it should apply <a href="../../models/2_horizontal_parallelism/">Horizontal Parallelism</a> strategy for selected model in-place.</p>
<p>If you use one of d9d's models, you may use default strategies for them such as <code>parallelize_qwen3_moe_for_causal_lm</code> (<a href="../../models/qwen3_moe/">reference</a>).</p>
<p>For a custom model, please see <a href="../../models/2_horizontal_parallelism/">Horizontal Parallelism</a> docs and reference implementations.</p>
<h4 id="implement-prepare_export_model_stage">Implement <code>prepare_export_model_stage(...)</code></h4>
<p>Implement the <code>prepare_export_model_stage(...)</code> method - it should return a <a href="../../model_states/mapper/">State Mapper</a> 
that converts in-memory model state to that one that will be saved on disk during final export.</p>
<p>Basically, it should reverse all the operations of <a href="../../model_states/mapper/">State Mapper</a> produced in <code>initialize_model_stage(...)</code>.</p>
<h3 id="example-implementation_1">Example Implementation</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">d9d.loop.control.model_provider</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">d9d.module.model.qwen3_moe</span><span class="w"> </span><span class="kn">import</span> <span class="n">Qwen3MoEForCausalLM</span><span class="p">,</span> <span class="n">Qwen3MoEForCausalLMParameters</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">d9d.module.parallelism.model.qwen3_moe</span><span class="w"> </span><span class="kn">import</span> <span class="n">parallelize_qwen3_moe_for_causal_lm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">d9d.module.block.hidden_states_aggregator</span><span class="w"> </span><span class="kn">import</span> <span class="n">HiddenStatesAggregationMode</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">d9d.model_state.mapper.adapters</span><span class="w"> </span><span class="kn">import</span> <span class="n">identity_mapper_from_module</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ModelProviderConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">Qwen3MoEForCausalLMParameters</span>  <span class="c1"># Hyperparameters for Qwen3 MoE</span>
    <span class="n">checkpointing</span><span class="p">:</span> <span class="nb">bool</span>  <span class="c1"># Enable gradient checkpointing to save VRAM</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ProjectModelProvider</span><span class="p">(</span><span class="n">ModelProvider</span><span class="p">[</span><span class="n">Qwen3MoEForCausalLM</span><span class="p">]):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">ModelProviderConfig</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">config</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">initialize_model_stage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">InitializeModelStageContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InitializeModelStageResult</span><span class="p">:</span>
        <span class="c1"># Initialize the raw model on Meta device in BF16 precision</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Qwen3MoEForCausalLM</span><span class="p">(</span>
            <span class="n">params</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
            <span class="n">stage</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">stage</span><span class="p">,</span>
            <span class="n">hidden_states_snapshot_mode</span><span class="o">=</span><span class="n">HiddenStatesAggregationMode</span><span class="o">.</span><span class="n">no</span><span class="p">,</span>
            <span class="n">enable_checkpointing</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">checkpointing</span>
        <span class="p">)</span><span class="o">.</span><span class="n">bfloat16</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">InitializeModelStageResult</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
            <span class="n">state_mapper</span><span class="o">=</span><span class="n">identity_mapper_from_module</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parallelize_model_stage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">ParallelizeModelStageContext</span><span class="p">):</span>
        <span class="c1"># Applies specific distributed strategies</span>
        <span class="c1"># suited for Qwen3 MoE architecture.</span>
        <span class="c1"># You can apply your own horizontal parallelism strategy here.</span>
        <span class="n">parallelize_qwen3_moe_for_causal_lm</span><span class="p">(</span>
            <span class="n">dist_context</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">dist_context</span><span class="p">,</span>
            <span class="n">stage</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">stage</span><span class="p">,</span>
            <span class="n">model</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">model</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_export_model_stage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">PrepareExportModelStageContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PrepareExportModelStageResult</span><span class="p">:</span>
        <span class="c1"># When exporting, save model weights as-is</span>

        <span class="k">return</span> <span class="n">PrepareExportModelStageResult</span><span class="p">(</span>
            <span class="n">state_mapper</span><span class="o">=</span><span class="n">identity_mapper_from_module</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dump_hparams</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScalarTree</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="api-reference_1">API Reference</h3>


<div class="doc doc-object doc-module">



<h3 id="d9d.loop.control.model_provider" class="doc doc-heading">
            <code>d9d.loop.control.model_provider</code>


</h3>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.model_provider.InitializeModelStageContext" class="doc doc-heading">
            <code>InitializeModelStageContext</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">



        <p>Context data required for initializing a specific model pipeline stage.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.model_provider.InitializeModelStageContext.dist_context">dist_context</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DistributedContext (d9d.core.dist_context.DistributedContext)" href="../../core/dist_context/#d9d.core.dist_context.DistributedContext">DistributedContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distributed execution context.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.model_provider.InitializeModelStageContext.stage">stage</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PipelineStageInfo


  
      dataclass
   (d9d.pipelining.api.PipelineStageInfo)" href="../../models/3_pipeline_parallelism/#d9d.pipelining.api.PipelineStageInfo">PipelineStageInfo</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metadata describing the current pipeline stage being initialized.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/model_provider.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">InitializeModelStageContext</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Context data required for initializing a specific model pipeline stage.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        dist_context: The distributed execution context.</span>
<span class="sd">        stage: Metadata describing the current pipeline stage being initialized.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dist_context</span><span class="p">:</span> <span class="n">DistributedContext</span>
    <span class="n">stage</span><span class="p">:</span> <span class="n">PipelineStageInfo</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.model_provider.InitializeModelStageResult" class="doc doc-heading">
            <code>InitializeModelStageResult</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="d9d.loop.control.model_provider.TModel">TModel</span>]</code></p>



        <p>The result of initializing a model stage.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.model_provider.InitializeModelStageResult.model">model</span></code></td>
            <td>
                  <code><span title="d9d.loop.control.model_provider.TModel">TModel</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PyTorch module.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.model_provider.InitializeModelStageResult.state_mapper">state_mapper</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ModelStateMapper (d9d.model_state.mapper.ModelStateMapper)" href="../../model_states/mapper/#d9d.model_state.mapper.ModelStateMapper">ModelStateMapper</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The mapper defining how to load weights into this module.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/model_provider.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">InitializeModelStageResult</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">TModel</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The result of initializing a model stage.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        model: The PyTorch module.</span>
<span class="sd">        state_mapper: The mapper defining how to load weights into this module.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">model</span><span class="p">:</span> <span class="n">TModel</span>
    <span class="n">state_mapper</span><span class="p">:</span> <span class="n">ModelStateMapper</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.model_provider.ModelProvider" class="doc doc-heading">
            <code>ModelProvider</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code>, <code><span title="typing.Generic">Generic</span>[<span title="d9d.loop.control.model_provider.TModel">TModel</span>]</code></p>



        <p>Abstract interface for defining the lifecycle of a distributed model.</p>
<p>This provider handles initialization, parallelization (sharding/replication/etc), and export preparation
for models within the d9d framework.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/model_provider.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ModelProvider</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">,</span> <span class="n">Generic</span><span class="p">[</span><span class="n">TModel</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract interface for defining the lifecycle of a distributed model.</span>

<span class="sd">    This provider handles initialization, parallelization (sharding/replication/etc), and export preparation</span>
<span class="sd">    for models within the d9d framework.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">initialize_model_stage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">InitializeModelStageContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InitializeModelStageResult</span><span class="p">[</span><span class="n">TModel</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the model architecture for a specific pipeline stage.</span>

<span class="sd">        This method is responsible for constructing the `nn.Module` for the requested stage.</span>

<span class="sd">        Construction occurs within a meta-device context; therefore, weights</span>
<span class="sd">        should not be loaded directly here. Instead, a `ModelStateMapper` must be returned</span>
<span class="sd">        to define how weights from a checkpoint map to the newly created module parameters.</span>

<span class="sd">        This allows for architecture modifications, such as injecting LoRA adapters,</span>
<span class="sd">        provided that the returned mapper reflects the new structure.</span>

<span class="sd">        Args:</span>
<span class="sd">            context: Context for this operation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Result of this operation.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="o">...</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parallelize_model_stage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">ParallelizeModelStageContext</span><span class="p">[</span><span class="n">TModel</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts the model parameters into distributed tensors (DTensors).</span>

<span class="sd">        Implementations should modify the model in-place. This involves converting</span>
<span class="sd">        standard parameters into DTensors by replicating or sharding them according</span>
<span class="sd">        to the desired parallelism strategies.</span>

<span class="sd">        Args:</span>
<span class="sd">            context: Context for this operation.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_export_model_stage</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">PrepareExportModelStageContext</span><span class="p">[</span><span class="n">TModel</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PrepareExportModelStageResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prepares the state mapper required for saving the model to disk.</span>

<span class="sd">        This methods defines how the current in-memory model structure maps back to the</span>
<span class="sd">        serialized checkpoint format.</span>

<span class="sd">        Args:</span>
<span class="sd">            context: Context for this operation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Result of this operation.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dump_hparams</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScalarTree</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports hyperparameters associated with this model for logging.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dictionary of hyperparameter names and values.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="d9d.loop.control.model_provider.ModelProvider.dump_hparams" class="doc doc-heading">
            <code class=" language-python"><span class="n">dump_hparams</span><span class="p">()</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Exports hyperparameters associated with this model for logging.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ScalarTree = PyTree[str | float | int | bool]

  
      module-attribute
   (d9d.core.types.ScalarTree)" href="../../core/types/#d9d.core.types.ScalarTree">ScalarTree</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of hyperparameter names and values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/control/model_provider.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dump_hparams</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScalarTree</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exports hyperparameters associated with this model for logging.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dictionary of hyperparameter names and values.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="d9d.loop.control.model_provider.ModelProvider.initialize_model_stage" class="doc doc-heading">
            <code class=" language-python"><span class="n">initialize_model_stage</span><span class="p">(</span><span class="n">context</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Initializes the model architecture for a specific pipeline stage.</p>
<p>This method is responsible for constructing the <code>nn.Module</code> for the requested stage.</p>
<p>Construction occurs within a meta-device context; therefore, weights
should not be loaded directly here. Instead, a <code>ModelStateMapper</code> must be returned
to define how weights from a checkpoint map to the newly created module parameters.</p>
<p>This allows for architecture modifications, such as injecting LoRA adapters,
provided that the returned mapper reflects the new structure.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="InitializeModelStageContext


  
      dataclass
   (d9d.loop.control.model_provider.InitializeModelStageContext)" href="#d9d.loop.control.model_provider.InitializeModelStageContext">InitializeModelStageContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Context for this operation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table></div>


    <p><span class="doc-section-title">Returns:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="InitializeModelStageResult


  
      dataclass
   (d9d.loop.control.model_provider.InitializeModelStageResult)" href="#d9d.loop.control.model_provider.InitializeModelStageResult">InitializeModelStageResult</a>[<span title="d9d.loop.control.model_provider.TModel">TModel</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Result of this operation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/control/model_provider.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">initialize_model_stage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">InitializeModelStageContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InitializeModelStageResult</span><span class="p">[</span><span class="n">TModel</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes the model architecture for a specific pipeline stage.</span>

<span class="sd">    This method is responsible for constructing the `nn.Module` for the requested stage.</span>

<span class="sd">    Construction occurs within a meta-device context; therefore, weights</span>
<span class="sd">    should not be loaded directly here. Instead, a `ModelStateMapper` must be returned</span>
<span class="sd">    to define how weights from a checkpoint map to the newly created module parameters.</span>

<span class="sd">    This allows for architecture modifications, such as injecting LoRA adapters,</span>
<span class="sd">    provided that the returned mapper reflects the new structure.</span>

<span class="sd">    Args:</span>
<span class="sd">        context: Context for this operation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Result of this operation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="o">...</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="d9d.loop.control.model_provider.ModelProvider.parallelize_model_stage" class="doc doc-heading">
            <code class=" language-python"><span class="n">parallelize_model_stage</span><span class="p">(</span><span class="n">context</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Converts the model parameters into distributed tensors (DTensors).</p>
<p>Implementations should modify the model in-place. This involves converting
standard parameters into DTensors by replicating or sharding them according
to the desired parallelism strategies.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ParallelizeModelStageContext


  
      dataclass
   (d9d.loop.control.model_provider.ParallelizeModelStageContext)" href="#d9d.loop.control.model_provider.ParallelizeModelStageContext">ParallelizeModelStageContext</a>[<span title="d9d.loop.control.model_provider.TModel">TModel</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Context for this operation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/control/model_provider.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">parallelize_model_stage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">ParallelizeModelStageContext</span><span class="p">[</span><span class="n">TModel</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the model parameters into distributed tensors (DTensors).</span>

<span class="sd">    Implementations should modify the model in-place. This involves converting</span>
<span class="sd">    standard parameters into DTensors by replicating or sharding them according</span>
<span class="sd">    to the desired parallelism strategies.</span>

<span class="sd">    Args:</span>
<span class="sd">        context: Context for this operation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="d9d.loop.control.model_provider.ModelProvider.prepare_export_model_stage" class="doc doc-heading">
            <code class=" language-python"><span class="n">prepare_export_model_stage</span><span class="p">(</span><span class="n">context</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Prepares the state mapper required for saving the model to disk.</p>
<p>This methods defines how the current in-memory model structure maps back to the
serialized checkpoint format.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PrepareExportModelStageContext


  
      dataclass
   (d9d.loop.control.model_provider.PrepareExportModelStageContext)" href="#d9d.loop.control.model_provider.PrepareExportModelStageContext">PrepareExportModelStageContext</a>[<span title="d9d.loop.control.model_provider.TModel">TModel</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Context for this operation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table></div>


    <p><span class="doc-section-title">Returns:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="PrepareExportModelStageResult


  
      dataclass
   (d9d.loop.control.model_provider.PrepareExportModelStageResult)" href="#d9d.loop.control.model_provider.PrepareExportModelStageResult">PrepareExportModelStageResult</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Result of this operation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/control/model_provider.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">prepare_export_model_stage</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">PrepareExportModelStageContext</span><span class="p">[</span><span class="n">TModel</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PrepareExportModelStageResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prepares the state mapper required for saving the model to disk.</span>

<span class="sd">    This methods defines how the current in-memory model structure maps back to the</span>
<span class="sd">    serialized checkpoint format.</span>

<span class="sd">    Args:</span>
<span class="sd">        context: Context for this operation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Result of this operation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.model_provider.ParallelizeModelStageContext" class="doc doc-heading">
            <code>ParallelizeModelStageContext</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="d9d.loop.control.model_provider.TModel">TModel</span>]</code></p>



        <p>Context data required for horizontally parallelizing a model stage.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.model_provider.ParallelizeModelStageContext.dist_context">dist_context</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DistributedContext (d9d.core.dist_context.DistributedContext)" href="../../core/dist_context/#d9d.core.dist_context.DistributedContext">DistributedContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distributed execution context.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.model_provider.ParallelizeModelStageContext.stage">stage</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PipelineStageInfo


  
      dataclass
   (d9d.pipelining.api.PipelineStageInfo)" href="../../models/3_pipeline_parallelism/#d9d.pipelining.api.PipelineStageInfo">PipelineStageInfo</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metadata describing the current pipeline stage.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.model_provider.ParallelizeModelStageContext.model">model</span></code></td>
            <td>
                  <code><span title="d9d.loop.control.model_provider.TModel">TModel</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PyTorch module to be parallelized.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/model_provider.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ParallelizeModelStageContext</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">TModel</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Context data required for horizontally parallelizing a model stage.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        dist_context: The distributed execution context.</span>
<span class="sd">        stage: Metadata describing the current pipeline stage.</span>
<span class="sd">        model: The PyTorch module to be parallelized.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dist_context</span><span class="p">:</span> <span class="n">DistributedContext</span>
    <span class="n">stage</span><span class="p">:</span> <span class="n">PipelineStageInfo</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">TModel</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.model_provider.PrepareExportModelStageContext" class="doc doc-heading">
            <code>PrepareExportModelStageContext</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="d9d.loop.control.model_provider.TModel">TModel</span>]</code></p>



        <p>Context data required for preparing a model stage for export.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.model_provider.PrepareExportModelStageContext.dist_context">dist_context</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DistributedContext (d9d.core.dist_context.DistributedContext)" href="../../core/dist_context/#d9d.core.dist_context.DistributedContext">DistributedContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distributed execution context.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.model_provider.PrepareExportModelStageContext.model">model</span></code></td>
            <td>
                  <code><span title="d9d.loop.control.model_provider.TModel">TModel</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PyTorch module to be exported.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/model_provider.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PrepareExportModelStageContext</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">TModel</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Context data required for preparing a model stage for export.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        dist_context: The distributed execution context.</span>
<span class="sd">        model: The PyTorch module to be exported.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dist_context</span><span class="p">:</span> <span class="n">DistributedContext</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">TModel</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.model_provider.PrepareExportModelStageResult" class="doc doc-heading">
            <code>PrepareExportModelStageResult</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">



        <p>The result of preparing a model stage for export.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.model_provider.PrepareExportModelStageResult.state_mapper">state_mapper</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ModelStateMapper (d9d.model_state.mapper.ModelStateMapper)" href="../../model_states/mapper/#d9d.model_state.mapper.ModelStateMapper">ModelStateMapper</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The mapper defining how model parameters map to disk storage.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/model_provider.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PrepareExportModelStageResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The result of preparing a model stage for export.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        state_mapper: The mapper defining how model parameters map to disk storage.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">state_mapper</span><span class="p">:</span> <span class="n">ModelStateMapper</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="data-loading">Data Loading</h2>
<h3 id="datasetprovider">DatasetProvider</h3>
<p>The <code>DatasetProvider</code> is responsible for creating dataset and data collator instances.</p>
<h3 id="distributed-awareness">Distributed-Awareness</h3>
<p>d9d <strong>will not</strong> apply sharding to your dataset automatically. You have to configure it manually (optionally applying other dataset wrappers).</p>
<p>Please see the <a href="../../dataset/">Dataset Utilities</a> documentation.</p>
<h3 id="example-implementation_2">Example Implementation</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Sequence</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datasets</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tokenizers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tokenizer</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">d9d.core.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">TensorTree</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">d9d.dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">BufferSortedDataset</span><span class="p">,</span> <span class="n">shard_dataset_data_parallel</span><span class="p">,</span> <span class="n">DatasetImplementingSortKeyProtocol</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">d9d.loop.control.dataset_provider</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ProjectDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">DatasetImplementingSortKeyProtocol</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">:</span> <span class="n">Tokenizer</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dataset</span> <span class="o">=</span> <span class="n">dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span> <span class="o">=</span> <span class="n">tokenizer</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sort_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="c1"># Used by BufferSortedDataset to group examples of similar length together.</span>
        <span class="c1"># This minimizes padding overhead in batches.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataset</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">&quot;token_counts&quot;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TensorTree</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="o">...</span>
        <span class="p">}</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">collate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="o">...</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataset</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">DataConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># HuggingFace dataset path/name</span>
    <span class="n">split</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># e.g., &#39;train&#39;, &#39;validation&#39;</span>
    <span class="n">text_column</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># The column containing the raw text</span>
    <span class="n">use_samples</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># Limit dataset size for testing/debugging</span>
    <span class="n">shuffle_seed</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># Distinct seed for shuffling the data</span>
    <span class="n">tokenizer</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># Path to the tokenizer.json file</span>
    <span class="n">num_proc</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># Number of CPU processes for data mapping</span>
    <span class="n">presort_buffer_size</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># Size of buffer for length-based presorting</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ProjectDatasetProvider</span><span class="p">(</span><span class="n">DatasetProvider</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">DataConfig</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">config</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_count_tokens</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">text_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">:</span> <span class="n">Tokenizer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;token_counts&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="n">text_column</span><span class="p">])</span><span class="o">.</span><span class="n">tokens</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">InitializeDatasetContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InitializeDatasetResult</span><span class="p">:</span>
        <span class="n">tokenizer</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">))</span>
        <span class="c1"># IMPORTANT: main_process_first ensures that Rank 0 downloads/processes</span>
        <span class="c1"># the dataset and builds the cache first. Ranks 1-N wait, then load from cache.</span>
        <span class="c1"># Prevents race conditions and corruption on the HF cache.</span>
        <span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">dist_context</span><span class="o">.</span><span class="n">main_process_first</span><span class="p">():</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">dataset</span><span class="p">,</span>
                <span class="n">split</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">split</span>
            <span class="p">)</span><span class="o">.</span><span class="n">take</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">use_samples</span>
            <span class="p">)</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">shuffle_seed</span>
            <span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_count_tokens</span><span class="p">,</span>
                <span class="n">num_proc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">num_proc</span><span class="p">,</span>
                <span class="n">fn_kwargs</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;tokenizer&quot;</span><span class="p">:</span> <span class="n">tokenizer</span><span class="p">,</span>
                    <span class="s2">&quot;text_column&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">text_column</span>
                <span class="p">}</span>
            <span class="p">)</span>

        <span class="n">dataset</span> <span class="o">=</span> <span class="n">ProjectDataset</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">)</span>

        <span class="c1"># BufferSortedDataset acts as a buffer that shuffles data locally</span>
        <span class="c1"># but outputs batches sorted by length (defined in sort_key above)</span>
        <span class="n">dataset_buf</span> <span class="o">=</span> <span class="n">BufferSortedDataset</span><span class="p">(</span>
            <span class="n">dataset</span><span class="p">,</span>
            <span class="n">buffer_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">presort_buffer_size</span><span class="p">,</span>
            <span class="n">pack_size</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">batch_maths</span><span class="o">.</span><span class="n">global_batch_size</span><span class="p">,</span>
            <span class="n">init_seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">shuffle_seed</span>
        <span class="p">)</span>

        <span class="c1"># Split dataset across data parallel ranks</span>
        <span class="n">dataset_shard</span> <span class="o">=</span> <span class="n">shard_dataset_data_parallel</span><span class="p">(</span><span class="n">dataset_buf</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">dist_context</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">InitializeDatasetResult</span><span class="p">(</span>
            <span class="n">dataset</span><span class="o">=</span><span class="n">dataset_shard</span><span class="p">,</span>
            <span class="n">collator</span><span class="o">=</span><span class="n">ProjectDataset</span><span class="o">.</span><span class="n">collate</span>
        <span class="p">)</span>
</code></pre></div>

<h3 id="api-reference_2">API Reference</h3>


<div class="doc doc-object doc-module">



<h3 id="d9d.loop.control.dataset_provider" class="doc doc-heading">
            <code>d9d.loop.control.dataset_provider</code>


</h3>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.dataset_provider.DatasetProvider" class="doc doc-heading">
            <code>DatasetProvider</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Protocol">Protocol</span></code></p>



        <p>Protocol that allows users to define how datasets are loaded and collated.</p>
<p>Users should subclass this to provide custom data loading logic.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/dataset_provider.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typing</span><span class="o">.</span><span class="n">runtime_checkable</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DatasetProvider</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Protocol that allows users to define how datasets are loaded and collated.</span>

<span class="sd">    Users should subclass this to provide custom data loading logic.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">InitializeDatasetContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InitializeDatasetResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the dataset components.</span>

<span class="sd">        It is important that the user must shard the dataset manually, perhaps using `d9d.dataset.ShardedDataset`.</span>

<span class="sd">        Args:</span>
<span class="sd">            context: Context for this operation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Result of this operation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="d9d.loop.control.dataset_provider.DatasetProvider.__call__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">context</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Initializes the dataset components.</p>
<p>It is important that the user must shard the dataset manually, perhaps using <code>d9d.dataset.ShardedDataset</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="InitializeDatasetContext


  
      dataclass
   (d9d.loop.control.dataset_provider.InitializeDatasetContext)" href="#d9d.loop.control.dataset_provider.InitializeDatasetContext">InitializeDatasetContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Context for this operation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table></div>


    <p><span class="doc-section-title">Returns:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="InitializeDatasetResult


  
      dataclass
   (d9d.loop.control.dataset_provider.InitializeDatasetResult)" href="#d9d.loop.control.dataset_provider.InitializeDatasetResult">InitializeDatasetResult</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Result of this operation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/control/dataset_provider.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">InitializeDatasetContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InitializeDatasetResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes the dataset components.</span>

<span class="sd">    It is important that the user must shard the dataset manually, perhaps using `d9d.dataset.ShardedDataset`.</span>

<span class="sd">    Args:</span>
<span class="sd">        context: Context for this operation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Result of this operation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.dataset_provider.InitializeDatasetContext" class="doc doc-heading">
            <code>InitializeDatasetContext</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">



        <p>Context data required to initialize a dataset provider.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.dataset_provider.InitializeDatasetContext.dist_context">dist_context</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DistributedContext (d9d.core.dist_context.DistributedContext)" href="../../core/dist_context/#d9d.core.dist_context.DistributedContext">DistributedContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distributed context containing rank and world size information.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.dataset_provider.InitializeDatasetContext.batch_maths">batch_maths</span></code></td>
            <td>
                  <code><span title="d9d.loop.component.BatchMaths">BatchMaths</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The batch maths component handling global batch size calculations.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/dataset_provider.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">InitializeDatasetContext</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Context data required to initialize a dataset provider.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        dist_context: The distributed context containing rank and world size information.</span>
<span class="sd">        batch_maths: The batch maths component handling global batch size calculations.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dist_context</span><span class="p">:</span> <span class="n">DistributedContext</span>
    <span class="n">batch_maths</span><span class="p">:</span> <span class="s2">&quot;BatchMaths&quot;</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.dataset_provider.InitializeDatasetResult" class="doc doc-heading">
            <code>InitializeDatasetResult</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">



        <p>The result of initializing a dataset provider.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.dataset_provider.InitializeDatasetResult.dataset">dataset</span></code></td>
            <td>
                  <code><span title="torch.utils.data.Dataset">Dataset</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The instantiated PyTorch Dataset.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.dataset_provider.InitializeDatasetResult.collator">collator</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CollateFn = Callable[[Sequence[TDataTree]], TDataTree]

  
      module-attribute
   (d9d.core.types.CollateFn)" href="../../core/types/#d9d.core.types.CollateFn">CollateFn</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function used to collate individual samples into a batch.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/dataset_provider.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">InitializeDatasetResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The result of initializing a dataset provider.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        dataset: The instantiated PyTorch Dataset.</span>
<span class="sd">        collator: The function used to collate individual samples into a batch.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dataset</span><span class="p">:</span> <span class="n">Dataset</span>
    <span class="n">collator</span><span class="p">:</span> <span class="n">CollateFn</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="optimization-scheduling">Optimization &amp; Scheduling</h2>
<h3 id="auto-implementations">Auto Implementations</h3>
<p>For standard PyTorch usage, <code>d9d</code> includes the <code>d9d.loop.auto</code> package. These providers ingest a Pydantic configuration object and manage the creation of standard optimizers and schedulers.</p>
<h4 id="auto-optimizer">Auto Optimizer</h4>
<p>Supports <code>AdamW</code>, <code>Adam</code>, <code>SGD</code>, and <code>StochasticAdamW</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">d9d.loop.auto</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoOptimizerProvider</span><span class="p">,</span> <span class="n">AutoOptimizerConfig</span>

<span class="n">provider</span> <span class="o">=</span> <span class="n">AutoOptimizerProvider</span><span class="p">(</span>
    <span class="n">AutoOptimizerConfig</span><span class="o">.</span><span class="n">model_validate_json</span><span class="p">(</span><span class="s1">&#39;{&quot;name&quot;: &quot;adamw&quot;, &quot;lr&quot;: 1e-4}&#39;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>



<div class="doc doc-object doc-module">



<h3 id="d9d.loop.auto.auto_optimizer" class="doc doc-heading">
            <code>d9d.loop.auto.auto_optimizer</code>


</h3>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="d9d.loop.auto.auto_optimizer.AdamOptimizerConfig" class="doc doc-heading">
            <code>AdamOptimizerConfig</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseAutoOptimizerConfig (d9d.loop.auto.auto_optimizer.BaseAutoOptimizerConfig)" href="#d9d.loop.auto.auto_optimizer.BaseAutoOptimizerConfig">BaseAutoOptimizerConfig</a></code></p>



        <p>Configuration for the PyTorch Adam optimizer.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.AdamOptimizerConfig.name">name</span></code></td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;adam&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Discriminator tag.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.AdamOptimizerConfig.lr">lr</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The learning rate.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.AdamOptimizerConfig.betas">betas</span></code></td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coefficients for computing running averages of gradient and its square.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.AdamOptimizerConfig.eps">eps</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Term added to the denominator to improve numerical stability.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.AdamOptimizerConfig.weight_decay">weight_decay</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weight decay coefficient.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.AdamOptimizerConfig.decoupled_weight_decay">decoupled_weight_decay</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to apply decoupled weight decay.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.AdamOptimizerConfig.amsgrad">amsgrad</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use the AMSGrad variant.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.AdamOptimizerConfig.maximize">maximize</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to maximize the params based on the objective.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/auto/auto_optimizer.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AdamOptimizerConfig</span><span class="p">(</span><span class="n">BaseAutoOptimizerConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configuration for the PyTorch Adam optimizer.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        name: Discriminator tag.</span>
<span class="sd">        lr: The learning rate.</span>
<span class="sd">        betas: Coefficients for computing running averages of gradient and its square.</span>
<span class="sd">        eps: Term added to the denominator to improve numerical stability.</span>
<span class="sd">        weight_decay: Weight decay coefficient.</span>
<span class="sd">        decoupled_weight_decay: Whether to apply decoupled weight decay.</span>
<span class="sd">        amsgrad: Whether to use the AMSGrad variant.</span>
<span class="sd">        maximize: Whether to maximize the params based on the objective.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;adam&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;adam&quot;</span>

    <span class="n">lr</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">betas</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.999</span><span class="p">)</span>
    <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-8</span>
    <span class="n">weight_decay</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-2</span>
    <span class="n">decoupled_weight_decay</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">amsgrad</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">maximize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optimizer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Builds fused Adam with the configured parameters.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Adam</span><span class="p">(</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">lr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lr</span><span class="p">,</span>
            <span class="n">betas</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">betas</span><span class="p">,</span>
            <span class="n">eps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eps</span><span class="p">,</span>
            <span class="n">weight_decay</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_decay</span><span class="p">,</span>
            <span class="n">decoupled_weight_decay</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">decoupled_weight_decay</span><span class="p">,</span>
            <span class="n">amsgrad</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">amsgrad</span><span class="p">,</span>
            <span class="n">maximize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maximize</span><span class="p">,</span>
            <span class="n">fused</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="d9d.loop.auto.auto_optimizer.AdamOptimizerConfig.build" class="doc doc-heading">
            <code class=" language-python"><span class="n">build</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Builds fused Adam with the configured parameters.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/auto/auto_optimizer.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optimizer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Builds fused Adam with the configured parameters.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Adam</span><span class="p">(</span>
        <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
        <span class="n">lr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lr</span><span class="p">,</span>
        <span class="n">betas</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">betas</span><span class="p">,</span>
        <span class="n">eps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eps</span><span class="p">,</span>
        <span class="n">weight_decay</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_decay</span><span class="p">,</span>
        <span class="n">decoupled_weight_decay</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">decoupled_weight_decay</span><span class="p">,</span>
        <span class="n">amsgrad</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">amsgrad</span><span class="p">,</span>
        <span class="n">maximize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maximize</span><span class="p">,</span>
        <span class="n">fused</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.auto.auto_optimizer.AdamWOptimizerConfig" class="doc doc-heading">
            <code>AdamWOptimizerConfig</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseAutoOptimizerConfig (d9d.loop.auto.auto_optimizer.BaseAutoOptimizerConfig)" href="#d9d.loop.auto.auto_optimizer.BaseAutoOptimizerConfig">BaseAutoOptimizerConfig</a></code></p>



        <p>Configuration for the PyTorch AdamW optimizer.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.AdamWOptimizerConfig.name">name</span></code></td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;adamw&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Discriminator tag.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.AdamWOptimizerConfig.lr">lr</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The learning rate.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.AdamWOptimizerConfig.betas">betas</span></code></td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coefficients for computing running averages of gradient and its square.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.AdamWOptimizerConfig.eps">eps</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Term added to the denominator to improve numerical stability.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.AdamWOptimizerConfig.weight_decay">weight_decay</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weight decay coefficient.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.AdamWOptimizerConfig.amsgrad">amsgrad</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use the AMSGrad variant.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.AdamWOptimizerConfig.maximize">maximize</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to maximize the params based on the objective (as opposed to minimizing).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/auto/auto_optimizer.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AdamWOptimizerConfig</span><span class="p">(</span><span class="n">BaseAutoOptimizerConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configuration for the PyTorch AdamW optimizer.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        name: Discriminator tag.</span>
<span class="sd">        lr: The learning rate.</span>
<span class="sd">        betas: Coefficients for computing running averages of gradient and its square.</span>
<span class="sd">        eps: Term added to the denominator to improve numerical stability.</span>
<span class="sd">        weight_decay: Weight decay coefficient.</span>
<span class="sd">        amsgrad: Whether to use the AMSGrad variant.</span>
<span class="sd">        maximize: Whether to maximize the params based on the objective (as opposed to minimizing).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;adamw&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;adamw&quot;</span>

    <span class="n">lr</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">betas</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.999</span><span class="p">)</span>
    <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-8</span>
    <span class="n">weight_decay</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-2</span>
    <span class="n">amsgrad</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">maximize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optimizer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Builds fused AdamW with the configured parameters.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">AdamW</span><span class="p">(</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">lr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lr</span><span class="p">,</span>
            <span class="n">betas</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">betas</span><span class="p">,</span>
            <span class="n">eps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eps</span><span class="p">,</span>
            <span class="n">weight_decay</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_decay</span><span class="p">,</span>
            <span class="n">amsgrad</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">amsgrad</span><span class="p">,</span>
            <span class="n">maximize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maximize</span><span class="p">,</span>
            <span class="n">fused</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="d9d.loop.auto.auto_optimizer.AdamWOptimizerConfig.build" class="doc doc-heading">
            <code class=" language-python"><span class="n">build</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Builds fused AdamW with the configured parameters.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/auto/auto_optimizer.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optimizer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Builds fused AdamW with the configured parameters.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">AdamW</span><span class="p">(</span>
        <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
        <span class="n">lr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lr</span><span class="p">,</span>
        <span class="n">betas</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">betas</span><span class="p">,</span>
        <span class="n">eps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eps</span><span class="p">,</span>
        <span class="n">weight_decay</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_decay</span><span class="p">,</span>
        <span class="n">amsgrad</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">amsgrad</span><span class="p">,</span>
        <span class="n">maximize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maximize</span><span class="p">,</span>
        <span class="n">fused</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.auto.auto_optimizer.AutoOptimizerProvider" class="doc doc-heading">
            <code>AutoOptimizerProvider</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="OptimizerProvider (d9d.loop.control.OptimizerProvider)" href="#d9d.loop.control.optimizer_provider.OptimizerProvider">OptimizerProvider</a></code></p>



        <p>OptimizerProvider that builds a PyTorch optimizer based on a configuration object.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/auto/auto_optimizer.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AutoOptimizerProvider</span><span class="p">(</span><span class="n">OptimizerProvider</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    OptimizerProvider that builds a PyTorch optimizer based on a configuration object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">AutoOptimizerConfig</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructs the provider with the given configuration.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">config</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">InitializeOptimizerStageContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optimizer</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="d9d.loop.auto.auto_optimizer.AutoOptimizerProvider.__init__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Constructs the provider with the given configuration.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/auto/auto_optimizer.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">AutoOptimizerConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructs the provider with the given configuration.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.auto.auto_optimizer.BaseAutoOptimizerConfig" class="doc doc-heading">
            <code>BaseAutoOptimizerConfig</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code>, <code><span title="abc.ABC">ABC</span></code></p>



        <p>Abstract base class for optimizer configurations.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/auto/auto_optimizer.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BaseAutoOptimizerConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract base class for optimizer configurations.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optimizer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates the PyTorch optimizer instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            params: An iterable of model parameters to optimize.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The instantiated optimizer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="d9d.loop.auto.auto_optimizer.BaseAutoOptimizerConfig.build" class="doc doc-heading">
            <code class=" language-python"><span class="n">build</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Creates the PyTorch optimizer instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<span title="torch.nn.Parameter">Parameter</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An iterable of model parameters to optimize.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table></div>


    <p><span class="doc-section-title">Returns:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="torch.optim.Optimizer">Optimizer</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The instantiated optimizer.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/auto/auto_optimizer.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optimizer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates the PyTorch optimizer instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        params: An iterable of model parameters to optimize.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The instantiated optimizer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.auto.auto_optimizer.SGDOptimizerConfig" class="doc doc-heading">
            <code>SGDOptimizerConfig</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseAutoOptimizerConfig (d9d.loop.auto.auto_optimizer.BaseAutoOptimizerConfig)" href="#d9d.loop.auto.auto_optimizer.BaseAutoOptimizerConfig">BaseAutoOptimizerConfig</a></code></p>



        <p>Configuration for the PyTorch SGD optimizer.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.SGDOptimizerConfig.name">name</span></code></td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;sgd&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Discriminator tag.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.SGDOptimizerConfig.lr">lr</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The learning rate.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.SGDOptimizerConfig.momentum">momentum</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Momentum factor.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.SGDOptimizerConfig.dampening">dampening</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dampening for momentum.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.SGDOptimizerConfig.weight_decay">weight_decay</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weight decay (L2 penalty).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.SGDOptimizerConfig.nesterov">nesterov</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Enables Nesterov momentum.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.SGDOptimizerConfig.maximize">maximize</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to maximize the params based on the objective.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/auto/auto_optimizer.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SGDOptimizerConfig</span><span class="p">(</span><span class="n">BaseAutoOptimizerConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configuration for the PyTorch SGD optimizer.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        name: Discriminator tag.</span>
<span class="sd">        lr: The learning rate.</span>
<span class="sd">        momentum: Momentum factor.</span>
<span class="sd">        dampening: Dampening for momentum.</span>
<span class="sd">        weight_decay: Weight decay (L2 penalty).</span>
<span class="sd">        nesterov: Enables Nesterov momentum.</span>
<span class="sd">        maximize: Whether to maximize the params based on the objective.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;sgd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sgd&quot;</span>

    <span class="n">lr</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">momentum</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">dampening</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">weight_decay</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">nesterov</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">maximize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optimizer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Builds fused SGD with the configured parameters.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">SGD</span><span class="p">(</span>
            <span class="n">params</span><span class="p">,</span>
            <span class="n">lr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lr</span><span class="p">,</span>
            <span class="n">momentum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">momentum</span><span class="p">,</span>
            <span class="n">dampening</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dampening</span><span class="p">,</span>
            <span class="n">weight_decay</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_decay</span><span class="p">,</span>
            <span class="n">nesterov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nesterov</span><span class="p">,</span>
            <span class="n">maximize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maximize</span><span class="p">,</span>
            <span class="n">fused</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="d9d.loop.auto.auto_optimizer.SGDOptimizerConfig.build" class="doc doc-heading">
            <code class=" language-python"><span class="n">build</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Builds fused SGD with the configured parameters.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/auto/auto_optimizer.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optimizer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Builds fused SGD with the configured parameters.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">SGD</span><span class="p">(</span>
        <span class="n">params</span><span class="p">,</span>
        <span class="n">lr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lr</span><span class="p">,</span>
        <span class="n">momentum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">momentum</span><span class="p">,</span>
        <span class="n">dampening</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dampening</span><span class="p">,</span>
        <span class="n">weight_decay</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_decay</span><span class="p">,</span>
        <span class="n">nesterov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nesterov</span><span class="p">,</span>
        <span class="n">maximize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maximize</span><span class="p">,</span>
        <span class="n">fused</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.auto.auto_optimizer.StochasticAdamWOptimizerConfig" class="doc doc-heading">
            <code>StochasticAdamWOptimizerConfig</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseAutoOptimizerConfig (d9d.loop.auto.auto_optimizer.BaseAutoOptimizerConfig)" href="#d9d.loop.auto.auto_optimizer.BaseAutoOptimizerConfig">BaseAutoOptimizerConfig</a></code></p>



        <p>Configuration for the Stochastic AdamW optimizer.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.StochasticAdamWOptimizerConfig.name">name</span></code></td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;stochastic_adamw&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Discriminator tag.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.StochasticAdamWOptimizerConfig.lr">lr</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Learning rate.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.StochasticAdamWOptimizerConfig.betas">betas</span></code></td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coefficients used for computing running averages of gradient and its square.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.StochasticAdamWOptimizerConfig.eps">eps</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Term added to the denominator to improve numerical stability.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.StochasticAdamWOptimizerConfig.weight_decay">weight_decay</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weight decay coefficient.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_optimizer.StochasticAdamWOptimizerConfig.state_dtype">state_dtype</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data Type to use for the optimizer states.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/auto/auto_optimizer.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">StochasticAdamWOptimizerConfig</span><span class="p">(</span><span class="n">BaseAutoOptimizerConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configuration for the Stochastic AdamW optimizer.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        name: Discriminator tag.</span>
<span class="sd">        lr: Learning rate.</span>
<span class="sd">        betas: Coefficients used for computing running averages of gradient and its square.</span>
<span class="sd">        eps: Term added to the denominator to improve numerical stability.</span>
<span class="sd">        weight_decay: Weight decay coefficient.</span>
<span class="sd">        state_dtype: Data Type to use for the optimizer states.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;stochastic_adamw&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;stochastic_adamw&quot;</span>

    <span class="n">lr</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">betas</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.999</span><span class="p">)</span>
    <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-8</span>
    <span class="n">weight_decay</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-2</span>
    <span class="n">state_dtype</span><span class="p">:</span> <span class="nb">str</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optimizer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Builds StochasticAdamW with the configured parameters.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">StochasticAdamW</span><span class="p">(</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">lr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lr</span><span class="p">,</span>
            <span class="n">betas</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">betas</span><span class="p">,</span>
            <span class="n">eps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eps</span><span class="p">,</span>
            <span class="n">weight_decay</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_decay</span><span class="p">,</span>
            <span class="n">state_dtype</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">torch</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_dtype</span><span class="p">),</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="d9d.loop.auto.auto_optimizer.StochasticAdamWOptimizerConfig.build" class="doc doc-heading">
            <code class=" language-python"><span class="n">build</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Builds StochasticAdamW with the configured parameters.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/auto/auto_optimizer.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optimizer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Builds StochasticAdamW with the configured parameters.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">StochasticAdamW</span><span class="p">(</span>
        <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
        <span class="n">lr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lr</span><span class="p">,</span>
        <span class="n">betas</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">betas</span><span class="p">,</span>
        <span class="n">eps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eps</span><span class="p">,</span>
        <span class="n">weight_decay</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_decay</span><span class="p">,</span>
        <span class="n">state_dtype</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">torch</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_dtype</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h4 id="auto-scheduler">Auto Scheduler</h4>
<p>Supports <a href="../../lr_scheduler/piecewise/">Piecewise Linear</a> schedules (warmup, hold, decay).</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">d9d.loop.auto</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoLRSchedulerProvider</span><span class="p">,</span> <span class="n">AutoLRSchedulerConfig</span>

<span class="n">cfg</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">{</span>
<span class="s2">    &quot;initial_multiplier&quot;: 0.0,</span>
<span class="s2">    &quot;phases&quot;: [</span>
<span class="s2">        {</span>
<span class="s2">            &quot;mode&quot;: &quot;steps&quot;,</span>
<span class="s2">            &quot;steps&quot;: 100,</span>
<span class="s2">            &quot;target_multiplier&quot;: 1.0,</span>
<span class="s2">            &quot;curve&quot;: { &quot;type&quot;: &quot;linear&quot; }</span>
<span class="s2">        },</span>
<span class="s2">        {</span>
<span class="s2">            &quot;mode&quot;: &quot;rest&quot;,</span>
<span class="s2">            &quot;target_multiplier&quot;: 0.1,</span>
<span class="s2">            &quot;curve&quot;: { &quot;type&quot;: &quot;cosine&quot; }</span>
<span class="s2">        }</span>
<span class="s2">    ]</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">provider</span> <span class="o">=</span> <span class="n">AutoLRSchedulerProvider</span><span class="p">(</span>
    <span class="n">AutoLRSchedulerConfig</span><span class="o">.</span><span class="n">model_validate_json</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>



<div class="doc doc-object doc-module">



<h3 id="d9d.loop.auto.auto_lr_scheduler" class="doc doc-heading">
            <code>d9d.loop.auto.auto_lr_scheduler</code>


</h3>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="d9d.loop.auto.auto_lr_scheduler.AutoLRSchedulerProvider" class="doc doc-heading">
            <code>AutoLRSchedulerProvider</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="LRSchedulerProvider (d9d.loop.control.LRSchedulerProvider)" href="#d9d.loop.control.lr_scheduler_provider.LRSchedulerProvider">LRSchedulerProvider</a></code></p>



        <p>LRSchedulerProvider that builds a learning rate scheduler based on a configuration object.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/auto/auto_lr_scheduler.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AutoLRSchedulerProvider</span><span class="p">(</span><span class="n">LRSchedulerProvider</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LRSchedulerProvider that builds a learning rate scheduler based on a configuration object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">AutoLRSchedulerConfig</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructs the AutoLRSchedulerProvider object.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">config</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">InitializeLRSchedulerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LRSchedulerProtocol</span><span class="p">:</span>
        <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">PiecewiseConfig</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">piecewise_scheduler_from_config</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">scheduler</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">total_steps</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">total_steps</span>
                <span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported LR scheduler type: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="d9d.loop.auto.auto_lr_scheduler.AutoLRSchedulerProvider.__init__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Constructs the AutoLRSchedulerProvider object.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/auto/auto_lr_scheduler.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">AutoLRSchedulerConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructs the AutoLRSchedulerProvider object.&quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.auto.auto_lr_scheduler.PiecewiseConfig" class="doc doc-heading">
            <code>PiecewiseConfig</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>



        <p>Configuration for the piecewise learning rate scheduler.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_lr_scheduler.PiecewiseConfig.name">name</span></code></td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;piecewise&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Discriminator tag, must be "piecewise".</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.auto.auto_lr_scheduler.PiecewiseConfig.scheduler">scheduler</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PiecewiseSchedulerConfig (d9d.lr_scheduler.piecewise.PiecewiseSchedulerConfig)" href="../../lr_scheduler/piecewise/#d9d.lr_scheduler.piecewise.PiecewiseSchedulerConfig">PiecewiseSchedulerConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Detailed configuration for the piecewise schedule.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/auto/auto_lr_scheduler.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PiecewiseConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configuration for the piecewise learning rate scheduler.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        name: Discriminator tag, must be &quot;piecewise&quot;.</span>
<span class="sd">        scheduler: Detailed configuration for the piecewise schedule.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;piecewise&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;piecewise&quot;</span>

    <span class="n">scheduler</span><span class="p">:</span> <span class="n">PiecewiseSchedulerConfig</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div><h3 id="interface">Interface</h3>
<p>If you need a custom optimizer or learning rate scheduler, you implement the <code>OptimizerProvider</code> protocol.</p>


<div class="doc doc-object doc-module">



<h3 id="d9d.loop.control.optimizer_provider" class="doc doc-heading">
            <code>d9d.loop.control.optimizer_provider</code>


</h3>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.optimizer_provider.InitializeOptimizerStageContext" class="doc doc-heading">
            <code>InitializeOptimizerStageContext</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">



        <p>Context data required to initialize an optimizer.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.optimizer_provider.InitializeOptimizerStageContext.dist_context">dist_context</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DistributedContext (d9d.core.dist_context.DistributedContext)" href="../../core/dist_context/#d9d.core.dist_context.DistributedContext">DistributedContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distributed context.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.optimizer_provider.InitializeOptimizerStageContext.model">model</span></code></td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model instance for which parameters will be optimized.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/optimizer_provider.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">InitializeOptimizerStageContext</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Context data required to initialize an optimizer.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        dist_context: The distributed context.</span>
<span class="sd">        model: The model instance for which parameters will be optimized.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dist_context</span><span class="p">:</span> <span class="n">DistributedContext</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.optimizer_provider.OptimizerProvider" class="doc doc-heading">
            <code>OptimizerProvider</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Protocol">Protocol</span></code></p>



        <p>Protocol for defining how optimizers are created for model pipeline stages.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/optimizer_provider.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typing</span><span class="o">.</span><span class="n">runtime_checkable</span>
<span class="k">class</span><span class="w"> </span><span class="nc">OptimizerProvider</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Protocol for defining how optimizers are created for model pipeline stages.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">InitializeOptimizerStageContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optimizer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the optimizer for a specific training stage.</span>

<span class="sd">        Args:</span>
<span class="sd">            context: Context for this operation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The instantiated PyTorch optimizer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="d9d.loop.control.optimizer_provider.OptimizerProvider.__call__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">context</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Initializes the optimizer for a specific training stage.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="InitializeOptimizerStageContext


  
      dataclass
   (d9d.loop.control.optimizer_provider.InitializeOptimizerStageContext)" href="#d9d.loop.control.optimizer_provider.InitializeOptimizerStageContext">InitializeOptimizerStageContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Context for this operation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table></div>


    <p><span class="doc-section-title">Returns:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="torch.optim.Optimizer">Optimizer</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The instantiated PyTorch optimizer.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/control/optimizer_provider.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">InitializeOptimizerStageContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optimizer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes the optimizer for a specific training stage.</span>

<span class="sd">    Args:</span>
<span class="sd">        context: Context for this operation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The instantiated PyTorch optimizer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="d9d.loop.control.lr_scheduler_provider" class="doc doc-heading">
            <code>d9d.loop.control.lr_scheduler_provider</code>


</h3>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.lr_scheduler_provider.InitializeLRSchedulerContext" class="doc doc-heading">
            <code>InitializeLRSchedulerContext</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">



        <p>Context data required to initialize an LR scheduler.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.lr_scheduler_provider.InitializeLRSchedulerContext.dist_context">dist_context</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DistributedContext (d9d.core.dist_context.DistributedContext)" href="../../core/dist_context/#d9d.core.dist_context.DistributedContext">DistributedContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distributed context.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.lr_scheduler_provider.InitializeLRSchedulerContext.total_steps">total_steps</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The total number of training steps.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="d9d.loop.control.lr_scheduler_provider.InitializeLRSchedulerContext.optimizer">optimizer</span></code></td>
            <td>
                  <code><span title="torch.optim.Optimizer">Optimizer</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optimizer instance that the scheduler will control.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/lr_scheduler_provider.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">InitializeLRSchedulerContext</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Context data required to initialize an LR scheduler.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        dist_context: The distributed context.</span>
<span class="sd">        total_steps: The total number of training steps.</span>
<span class="sd">        optimizer: The optimizer instance that the scheduler will control.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dist_context</span><span class="p">:</span> <span class="n">DistributedContext</span>
    <span class="n">total_steps</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">optimizer</span><span class="p">:</span> <span class="n">Optimizer</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="d9d.loop.control.lr_scheduler_provider.LRSchedulerProvider" class="doc doc-heading">
            <code>LRSchedulerProvider</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Protocol">Protocol</span></code></p>



        <p>Protocol for defining how Learning Rate schedulers are created.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>d9d/loop/control/lr_scheduler_provider.py</code></summary>
                <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typing</span><span class="o">.</span><span class="n">runtime_checkable</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LRSchedulerProvider</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Protocol for defining how Learning Rate schedulers are created.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">InitializeLRSchedulerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LRSchedulerProtocol</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the LR scheduler for a specific model pipeline stage.</span>

<span class="sd">        Args:</span>
<span class="sd">            context: Context for this operation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The instantiated LR scheduler adhering to the protocol.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="d9d.loop.control.lr_scheduler_provider.LRSchedulerProvider.__call__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">context</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Initializes the LR scheduler for a specific model pipeline stage.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="InitializeLRSchedulerContext


  
      dataclass
   (d9d.loop.control.lr_scheduler_provider.InitializeLRSchedulerContext)" href="#d9d.loop.control.lr_scheduler_provider.InitializeLRSchedulerContext">InitializeLRSchedulerContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Context for this operation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table></div>


    <p><span class="doc-section-title">Returns:</span></p>
    <div class="table-wrapper"><table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="LRSchedulerProtocol (d9d.core.protocol.LRSchedulerProtocol)" href="../../core/types/#d9d.core.protocol.LRSchedulerProtocol">LRSchedulerProtocol</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The instantiated LR scheduler adhering to the protocol.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>d9d/loop/control/lr_scheduler_provider.py</code></summary>
              <div class="codehilite"><div class="table-wrapper"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">InitializeLRSchedulerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LRSchedulerProtocol</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes the LR scheduler for a specific model pipeline stage.</span>

<span class="sd">    Args:</span>
<span class="sd">        context: Context for this operation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The instantiated LR scheduler adhering to the protocol.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>
  </div>
</article>
                                <div class="mx-auto flex flex-wrap h-16 w-full max-w-2xl items-center gap-2 px-4 md:px-0">
    
    <a data-slot="button"
        class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive bg-secondary text-secondary-foreground hover:bg-secondary/80 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 shadow-none"
        href="/d9d/0_loop/config/">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
            class="tabler-icon tabler-icon-arrow-left ">
            <path d="M5 12l14 0"></path>
            <path d="M5 12l6 6"></path>
            <path d="M5 12l6 -6"></path>
        </svg>
        <span class="max-[500px]:hidden">Configuration</span>
    </a>
    
    
    <a data-slot="button"
        class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*='size-'])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive bg-secondary text-secondary-foreground hover:bg-secondary/80 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 ml-auto shadow-none"
        href="/d9d/core/autograd_extensions/">
        <span class="max-[500px]:hidden">Autograd Extensions</span>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
            class="tabler-icon tabler-icon-arrow-right ">
            <path d="M5 12l14 0"></path>
            <path d="M13 18l6 -6"></path>
            <path d="M13 6l6 6"></path>
        </svg>
    </a>
    
</div>
                                <dialog id="bottom-sidebar" onclick="onBottomSidebarDialogClick(event)" class="bg-transparent"
    style="position: fixed; left: 0px; top: 0px; transform: translate(0px, 58px); min-width: max-content; --radix-popper-transform-origin: 0% 0px; will-change: transform; z-index: 50; --radix-popper-available-width: 504px; --radix-popper-available-height: 857px; --radix-popper-anchor-width: 72.94999694824219px; --radix-popper-anchor-height: 32px;">
    <div data-side="bottom" data-align="start" data-state="open" role="dialog" data-slot="popover-content"
        class="text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 origin-(--radix-popover-content-transform-origin) border outline-hidden bg-background/90 no-scrollbar h-(--radix-popper-available-height) w-(--radix-popper-available-width) overflow-y-auto rounded-none border-none p-0 shadow-none backdrop-blur duration-100"
        style="--radix-popover-content-transform-origin: var(--radix-popper-transform-origin); --radix-popover-content-available-width: var(--radix-popper-available-width); --radix-popover-content-available-height: var(--radix-popper-available-height); --radix-popover-trigger-width: var(--radix-popper-anchor-width); --radix-popover-trigger-height: var(--radix-popper-anchor-height);"
        tabindex="-1">
        <div class="flex flex-col gap-12 overflow-auto px-6 py-6">
            
            
            

            
            <div class="flex flex-col gap-4">
                <div class="text-muted-foreground text-sm font-medium">Menu</div>
                <div class="flex flex-col gap-3">
                    
                    <a class="text-2xl font-medium" href="../..">
                        
                        Home
                        
                    </a>
                    
                    <a class="text-2xl font-medium" href="../../toc/">
                        
                        Table of Contents
                        
                    </a>
                    
                </div>
            </div>
            

            
            <div class="flex flex-col gap-8">
                
                <div class="flex flex-col gap-4">
                    <div class="text-muted-foreground text-sm font-medium">Loop</div>
                    
                    <div class="flex flex-col gap-3">
                        
                        <a class="text-2xl font-medium" href="../0_index/">
                            
                            Training Loop
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../1_inference_loop/">
                            
                            Inference Loop
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../config/">
                            
                            Configuration
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="./">
                            
                            Interfaces & Logic
                            
                        </a>
                        
                    </div>
                    
                </div>
                
                <div class="flex flex-col gap-4">
                    <div class="text-muted-foreground text-sm font-medium">Core</div>
                    
                    <div class="flex flex-col gap-3">
                        
                        <a class="text-2xl font-medium" href="../../core/autograd_extensions/">
                            
                            Autograd Extensions
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../core/dist_context/">
                            
                            Distributed Context
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../core/dist_ops/">
                            
                            Distributed Operations
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../core/sharding/">
                            
                            PyTree Sharding
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../core/types/">
                            
                            Typing Extensions
                            
                        </a>
                        
                    </div>
                    
                </div>
                
                <div class="flex flex-col gap-4">
                    <div class="text-muted-foreground text-sm font-medium">Dataset</div>
                    
                    <div class="flex flex-col gap-3">
                        
                        <a class="text-2xl font-medium" href="../../dataset/">
                            
                            Datasets
                            
                        </a>
                        
                    </div>
                    
                </div>
                
                <div class="flex flex-col gap-4">
                    <div class="text-muted-foreground text-sm font-medium">Internals</div>
                    
                    <div class="flex flex-col gap-3">
                        
                        <a class="text-2xl font-medium" href="../../internals/determinism/">
                            
                            Determinism
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../internals/grad_norm/">
                            
                            Gradient Norm & Clipping
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../internals/grad_sync/">
                            
                            Gradient Synchronization
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../internals/metric_collector/">
                            
                            Metric Collection
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../internals/pipeline_state/">
                            
                            Pipeline State Management
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../internals/pipelining/">
                            
                            Pipelining Internals
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../internals/profiling/">
                            
                            Distributed Profiling
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../internals/tracker_integration/">
                            
                            Experiment Tracking
                            
                        </a>
                        
                    </div>
                    
                </div>
                
                <div class="flex flex-col gap-4">
                    <div class="text-muted-foreground text-sm font-medium">Lr scheduler</div>
                    
                    <div class="flex flex-col gap-3">
                        
                        <a class="text-2xl font-medium" href="../../lr_scheduler/piecewise/">
                            
                            Piecewise Scheduler
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../lr_scheduler/visualization/">
                            
                            Visualization
                            
                        </a>
                        
                    </div>
                    
                </div>
                
                <div class="flex flex-col gap-4">
                    <div class="text-muted-foreground text-sm font-medium">Metric</div>
                    
                    <div class="flex flex-col gap-3">
                        
                        <a class="text-2xl font-medium" href="../../metric/0_index/">
                            
                            Metrics
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../metric/custom/">
                            
                            Custom Metrics
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../metric/implemented/">
                            
                            Implemented Metrics
                            
                        </a>
                        
                    </div>
                    
                </div>
                
                <div class="flex flex-col gap-4">
                    <div class="text-muted-foreground text-sm font-medium">Model states</div>
                    
                    <div class="flex flex-col gap-3">
                        
                        <a class="text-2xl font-medium" href="../../model_states/io/">
                            
                            Model State I/O
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../model_states/mapper/">
                            
                            Model State Mapper
                            
                        </a>
                        
                    </div>
                    
                </div>
                
                <div class="flex flex-col gap-4">
                    <div class="text-muted-foreground text-sm font-medium">Models</div>
                    
                    <div class="flex flex-col gap-3">
                        
                        <a class="text-2xl font-medium" href="../../models/1_model_design/">
                            
                            Model Design
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../models/2_horizontal_parallelism/">
                            
                            Horizontal Parallelism
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../models/3_pipeline_parallelism/">
                            
                            Pipeline Parallelism
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../models/4_model_catalogue/">
                            
                            Model Catalogue
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../models/qwen3_moe/">
                            
                            Qwen3 MoE
                            
                        </a>
                        
                    </div>
                    
                </div>
                
                <div class="flex flex-col gap-4">
                    <div class="text-muted-foreground text-sm font-medium">Modules</div>
                    
                    <div class="flex flex-col gap-3">
                        
                        <a class="text-2xl font-medium" href="../../modules/attention/">
                            
                            Attention Layers
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../modules/embedding/">
                            
                            Embeddings
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../modules/ffn/">
                            
                            Feed Forward Networks (FFN)
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../modules/head/">
                            
                            Model Heads
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../modules/hidden_states_aggregator/">
                            
                            Hidden States Aggregation
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../modules/moe/">
                            
                            Mixture of Experts (MoE)
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../modules/positional/">
                            
                            Positional Embeddings
                            
                        </a>
                        
                    </div>
                    
                </div>
                
                <div class="flex flex-col gap-4">
                    <div class="text-muted-foreground text-sm font-medium">Optimizer</div>
                    
                    <div class="flex flex-col gap-3">
                        
                        <a class="text-2xl font-medium" href="../../optimizer/stochastic/">
                            
                            Stochastic Optimizers
                            
                        </a>
                        
                    </div>
                    
                </div>
                
                <div class="flex flex-col gap-4">
                    <div class="text-muted-foreground text-sm font-medium">Peft</div>
                    
                    <div class="flex flex-col gap-3">
                        
                        <a class="text-2xl font-medium" href="../../peft/0_index/">
                            
                            PEFT Overview
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../peft/full_tune/">
                            
                            Full Fine-Tuning
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../peft/lora/">
                            
                            LoRA
                            
                        </a>
                        
                        <a class="text-2xl font-medium" href="../../peft/stack/">
                            
                            Method Stacking
                            
                        </a>
                        
                    </div>
                    
                </div>
                
            </div>
            
            

        </div>
    </div>
</dialog>
                            </div>
                            <div
                                class="sticky top-[calc(var(--header-height)+1px)] z-30 ml-auto hidden h-[calc(100svh-var(--header-height)-var(--footer-height))] w-72 flex-col gap-4 overflow-hidden overscroll-none pb-8 xl:flex">
                                <div class="h-(--top-spacing) shrink-0"></div>
                                <div view-transition-name="toc" class="no-scrollbar overflow-y-auto px-8">
    <div class="flex flex-col gap-2 p-4 pt-0 text-sm">
        <p class="text-muted-foreground bg-background sticky top-0 h-6 text-xs">On This Page</p>
        
        
        
        
        <a href="#about"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="2">
            About
        </a>
        

        
        <a href="#user-tasks"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="2">
            User Tasks
        </a>
        
        
        <a href="#traintask"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            TrainTask
        </a>
        
        <a href="#inferencetask"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            InferenceTask
        </a>
        
        <a href="#pipeline-state"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            Pipeline State
        </a>
        
        <a href="#example-implementation"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            Example Implementation
        </a>
        
        <a href="#api-reference"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            API Reference
        </a>
        
        <a href="#d9d.loop.control.task"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            task
        </a>
        
        

        
        <a href="#model-definition"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="2">
            Model Definition
        </a>
        
        
        <a href="#modelprovider"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            ModelProvider
        </a>
        
        <a href="#how-to-write-a-modelprovider"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            How to Write a ModelProvider
        </a>
        
        <a href="#example-implementation_1"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            Example Implementation
        </a>
        
        <a href="#api-reference_1"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            API Reference
        </a>
        
        <a href="#d9d.loop.control.model_provider"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            model_provider
        </a>
        
        

        
        <a href="#data-loading"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="2">
            Data Loading
        </a>
        
        
        <a href="#datasetprovider"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            DatasetProvider
        </a>
        
        <a href="#distributed-awareness"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            Distributed-Awareness
        </a>
        
        <a href="#example-implementation_2"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            Example Implementation
        </a>
        
        <a href="#api-reference_2"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            API Reference
        </a>
        
        <a href="#d9d.loop.control.dataset_provider"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            dataset_provider
        </a>
        
        

        
        <a href="#optimization-scheduling"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="2">
            Optimization &amp; Scheduling
        </a>
        
        
        <a href="#auto-implementations"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            Auto Implementations
        </a>
        
        <a href="#d9d.loop.auto.auto_optimizer"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            auto_optimizer
        </a>
        
        <a href="#d9d.loop.auto.auto_lr_scheduler"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            auto_lr_scheduler
        </a>
        
        <a href="#interface"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            Interface
        </a>
        
        <a href="#d9d.loop.control.optimizer_provider"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            optimizer_provider
        </a>
        
        <a href="#d9d.loop.control.lr_scheduler_provider"
            class="text-muted-foreground hover:text-foreground data-[active=true]:text-foreground text-[0.8rem] no-underline transition-colors data-[depth=3]:pl-4 data-[depth=4]:pl-6"
            data-active="false" data-depth="3">
            lr_scheduler_provider
        </a>
        
        

        
        
        
        

    </div>
    <div class="h-12"></div>
</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        <footer view-transition-name="footer"
    class="group-has-[.section-soft]/body:bg-surface/40 3xl:fixed:bg-transparent dark:bg-transparent">
    <div class="container-wrapper px-4 xl:px-6">
        <div class="flex h-(--footer-height) items-center justify-between">
            <div class="text-muted-foreground w-full text-center text-xs leading-loose sm:text-sm">
                
                <a href="https://github.com/asiffer/mkdocs-shadcn">shadcn theme</a> provided by
                <a href="https://github.com/asiffer">@asiffer</a>
            </div>
        </div>
    </div>
</footer>
    </div>
     

<script src="../../search/main.js"></script>


    

    <script src="../../js/copy-button.js"></script>
    <script>updatePygmentsStylesheet();</script>
    
    <script>fetchStargazers("https://github.com/d9d-project/d9d");</script>
    
    
    <script>
    for (const el of document.querySelectorAll(
        ".typography .doc code.language-python",
    )) {
        el.classList.add("codehilite");
    }

    for (const el of document.querySelectorAll("article .doc .doc-contents")) {
        el.innerHTML = el.innerHTML.trim();
    }
</script>
    
    
    <script type="speculationrules">
{
  "prerender": [
    {
      "where": {
          "selector_matches": ["#next-button", "#previous-button"],
      }
    }
  ]
}
</script>
</body>

</html>